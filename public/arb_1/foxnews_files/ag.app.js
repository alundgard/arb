/*! updated; 03-22-2018 04:03 PM **/


Modulr.define("core.plugins:Base64",["require"],function(require){var _keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",App=function(){};return App.prototype.decode=function(input){var chr1,chr2,chr3,enc1,enc2,enc3,enc4,output="",i=0;for(input=input.replace(/[^A-Za-z0-9\+\/\=]/g,"");i<input.length;)enc1=_keyStr.indexOf(input.charAt(i++)),enc2=_keyStr.indexOf(input.charAt(i++)),enc3=_keyStr.indexOf(input.charAt(i++)),enc4=_keyStr.indexOf(input.charAt(i++)),chr1=enc1<<2|enc2>>4,chr2=(15&enc2)<<4|enc3>>2,chr3=(3&enc3)<<6|enc4,output+=String.fromCharCode(chr1),64!==enc3&&(output+=String.fromCharCode(chr2)),64!==enc4&&(output+=String.fromCharCode(chr3));return output},App.prototype.encode=function(input){for(var chr1,chr2,chr3,enc1,enc2,enc3,enc4,output="",i=0;i<input.length;)chr1=input.charCodeAt(i++),chr2=input.charCodeAt(i++),chr3=input.charCodeAt(i++),enc1=chr1>>2,enc2=(3&chr1)<<4|chr2>>4,enc3=(15&chr2)<<2|chr3>>6,enc4=63&chr3,isNaN(chr2)?enc3=enc4=64:isNaN(chr3)&&(enc4=64),output=output+_keyStr.charAt(enc1)+_keyStr.charAt(enc2)+_keyStr.charAt(enc3)+_keyStr.charAt(enc4);return output},new App});
Modulr.define("core.plugins:BrowserVisibilityState",[],function(){var CALL_STACK=[];return new function(){function addEvent(event,callback){document.addEventListener?document.addEventListener(event,callback,!1):document.attachEvent&&document.attachEvent("on"+event,callback)}function triggerStack(state){for(var i=0;i<CALL_STACK.length;i++)CALL_STACK[i](getState(state))}function getState(val){return"focus"===val?"visible":"blur"===val?"hidden":"visible"!==val?"hidden":"visible"}this.onChange=function(callback){"function"==typeof callback&&CALL_STACK.push(callback)};var event,state,prefixArr=["moz","ms","o","webkit"],prefix="",hidden=null;if("hidden"in document)hidden="hidden",event="visibilitychange",state="visibilityState";else{for(var i=0;i<prefixArr.length;i++)if(prefixArr[i]+"Hidden"in document){prefix=prefixArr;break}prefix&&(hidden=prefix+"Hidden",event=prefix+"visibilitychange",state=prefix+"VisibilityState")}hidden?addEvent(event,function(){triggerStack(document[state])}):"onfocusin"in document?(addEvent("focusin",function(){triggerStack("focus")}),addEvent("focusout",function(){triggerStack("blur")})):(addEvent("focus",function(){triggerStack("focus")}),addEvent("blur",function(){triggerStack("blur")}))}});
Modulr.define("core.plugins:CallStackTrigger",function(){var App=function(){this.__vars={};var v=this.__vars;v._stack={},v._trigger=!1,v._data={}};App.prototype.trigger=function(trigger,data){var self=this,v=self.__vars;v._trigger=trigger,v._data[trigger]=void 0!==data?data:null,v._stack[trigger]&&callStack(self,trigger)},App.prototype.bind=function(trigger,callback){var self=this,v=self.__vars,stack=v._stack;if("function"!=typeof callback)return!1;stack[trigger]||(stack[trigger]=[]),stack[trigger].push(callback)};var callStack=function(self,trigger){var v=self.__vars,stack=v._stack,data=v._data;if(stack[trigger]){var arr=stack[trigger];for(x=0;x<arr.length;x++)"function"==typeof arr[x]&&arr[x](data[trigger]||null)}};return App});
Modulr.define("core.plugins:CommaVal",function(){return function(val){if(isNaN(val))return val;val=parseFloat(val);var x,str=val.toString(),sp=str.split("."),whole=sp[0].split(""),dec=sp[1]?"."+sp[1]:"";for(whole.reverse(),x=0;x<whole.length;x++)0!==x&&(x+1)%3==0&&whole[x+1]&&(whole[x]=","+whole[x]);return whole.reverse(),whole.join("")+dec}});
Modulr.define("core.plugins:CountdownTimer",["require","AKAMAI_TIME_HELPER"],function(require,EST){function fireIntervalStack(){for(var id in CALLBACK_STACK){var callback=CALLBACK_STACK[id];"function"==typeof callback&&callback()}}function getTimerInfo(ms,maxTime){ms=ms<0?0:ms;var info,secs=getVal(ms,1e3),mins=getVal(secs,60),hrs=getVal(mins,60),days=getVal(hrs,24);switch(maxTime){case"hours":info={secs:secs%60,mins:mins%60,hrs:hrs};break;default:info={secs:secs%60,mins:mins%60,hrs:hrs%24,days:days}}for(var i in info)info[i]=(info[i]<10?"0":"")+info[i];return info.done=!(ms>0),info.raw_ms=ms,info}function getVal(val,divisor){return val>0?Math.floor(val/divisor):0}var INTERVAL=!1,CALLBACK_STACK={},INSTANCE_UID_COUNTER=0,STACK_COUNTER=0,allowedMaxTimes=["days","hours"],currentTime=EST.getCurrent().getTime(),setIntervalTimer=function(){clearInterval(INTERVAL),INTERVAL=setInterval(function(){currentTime+=1e3,fireIntervalStack()},1e3)};return setIntervalTimer(),function(config){function executeDoneStack(){for(var i=0;i<DONE_STACK.length;i++){var callback=DONE_STACK[i];"function"==typeof callback&&callback()}}var Proto=this;if(config=config||{},!config.endTime)return!1;INSTANCE_UID_COUNTER++;var INSTANCE_UID=INSTANCE_UID_COUNTER,endTime=config.endTime.getTime(),maxTime=$.inArray(config.maxTime,allowedMaxTimes)?config.maxTime:"days",diff=!1,STACK_ID=[],DONE_STACK=[];currentTime=config.currentTime?config.currentTime.getTime():EST.getCurrent().getTime(),setIntervalTimer(),Proto._END_TIME=endTime,Proto.onTick=function(callback){if("function"!=typeof callback)return!1;diff=endTime-currentTime;var info=getTimerInfo(diff,maxTime);if(callback(info),info.done)executeDoneStack();else{STACK_COUNTER++;var key=[INSTANCE_UID,"stack",STACK_COUNTER].join("_");STACK_ID.push(key),CALLBACK_STACK[key]=function(){if(diff=endTime-currentTime,info=getTimerInfo(diff,maxTime),callback(info),info.done){try{delete CALLBACK_STACK[key]}catch(err){CALLBACK_STACK[key]=null}executeDoneStack()}}}},Proto.onDone=function(callback){Proto.isDone()?callback():DONE_STACK.push(callback)},Proto.getInfo=function(){return getTimerInfo(endTime-currentTime,maxTime)},Proto.isDone=function(){return!(endTime-currentTime>0)},Proto.stopCountdowns=function(all){if(all)clearInterval(INTERVAL);else for(var i=0;i<STACK_ID.length;i++){var key=STACK_ID[i];try{delete CALLBACK_STACK[key]}catch(err){CALLBACK_STACK[key]=null}}}}});
Modulr.define("core.plugins:Datasets",[],function(EventMessageHandler){function isArray(val){return"[object Array]"===Object.prototype.toString.call(val)}var DATASETS={},CALLBACK_STACK={};return window.FNC_datasets=isArray(window.FNC_datasets)?window.FNC_datasets:[],new function(){function processStack(){if(isArray(window.FNC_datasets))for(;window.FNC_datasets.length>0;){var item=window.FNC_datasets.shift();"object"==typeof item&&item.id&&void 0!==item.data&&(DATASETS[item.id]=item.data)}}function triggerListener(item){item.id&&void 0!==item.data&&(DATASETS[item.id]=item.data,triggerStack(item.id,item.data),processStack())}function triggerStack(id){if(CALLBACK_STACK[id])for(var i=0;i<CALLBACK_STACK[id].length;i++)CALLBACK_STACK[id][i](DATASETS[id])}var Proto=this;!function(){Object.defineProperty(window.FNC_datasets,"push",{configurable:!1,enumerable:!1,writable:!1,value:function(){for(var n=this.length,len=arguments.length,i=0;i<len;i++)triggerListener(arguments[i]);return n}})}(),processStack(),Proto.get=function(id){return processStack(),DATASETS[id]||null},Proto.onUpdate=function(id,callback){CALLBACK_STACK[id]||(CALLBACK_STACK[id]=[]),CALLBACK_STACK[id].push(callback)}}});
Modulr.define("core.plugins:DateTime",["jquery"],function(){return function(date,formatStr){formatStr=formatStr||null;var i,obj={month:date.getMonth(),day:date.getDay(),year:date.getFullYear(),date:date.getDate(),hour:date.getHours(),minutes:date.getMinutes(),seconds:date.getSeconds(),ampm:date.getHours()<12?"am":"pm",fullStr:date.toString()},getMonthString=function(n,type){type=type||"full";var month=["January","February","March","April","May","June","July","August","September","October","November","December"],ret=month[n]||"";return"short"===type&&(ret=ret.slice(0,3)),ret},toStr=function(val){return val=isNaN(val)?"":val,val.toString()},getDayString=function(n,type){type=type||"full";var day=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],ret=day[n]||"";return"short"===type&&(ret=ret.slice(0,3)),ret},replace={"${mm}":obj.month+1,"${month}":getMonthString(obj.month),"${month:short}":getMonthString(obj.month,"short"),"${day}":getDayString(obj.day),"${day:short}":getDayString(obj.day,"short"),"${yr}":obj.year,"${yr:short}":toStr(obj.year).substr(2),"${dd}":obj.date<10?"0"+toStr(obj.date):toStr(obj.date),"${ddTH}":function(n){if(n=n||"",n=n.toString(),n.length<1)return n;var val=parseInt(n,10),s="",lastDigit=parseInt(n.charAt(n.length-1),10);if(val>=11&&val<=13)s="th";else switch(lastDigit){case 1:s="st";break;case 2:s="nd";break;case 3:s="rd";break;default:s="th"}return n+s}(obj.date),"${hr}":(obj.hour>12?obj.hour-12:obj.hour)||12,"${hr:reg}":obj.hour>12?obj.hour-12:0===obj.hour?12:obj.hour,"${hr:mil}":obj.hour<10?"0"+toStr(obj.hour):toStr(obj.hour),"${min}":obj.minutes<10?"0"+toStr(obj.minutes):toStr(obj.minutes),"${sec}":obj.seconds<10?"0"+toStr(obj.seconds):toStr(obj.seconds),"${ampm}":obj.ampm,"${AMPM}":obj.ampm.toUpperCase(),"${AmPm}":obj.ampm.charAt(0).toUpperCase()+obj.ampm.charAt(1)};for(i in replace)for(var idx=formatStr.indexOf(i);-1!==idx;)formatStr=formatStr.replace(i,replace[i]),idx=formatStr.indexOf(i);return formatStr}});
Modulr.define("core.plugins:DependencyManager",["jquery","LoadAttempt"],function($,LoadAttempt){var CONST={prefix:"___"},ManagerPrototype=function(){this._TYPES=[]};ManagerPrototype.prototype.addInstance=function(type,dependencyArr){if("string"!=typeof type&&type.length<1)return!1;var self=this;self[prefixed(type)]?log("[DependencyManager.addDependency] '"+type+"' already exists."):(self._TYPES.push(type),self[prefixed(type)]=new Manager(type,this),$.isArray(dependencyArr)&&self.setDependency(type,dependencyArr))},ManagerPrototype.prototype.onReady=function(type,callback){if("string"!=typeof type||"function"!=typeof callback)return!1;var self=this;LoadAttempt(60,500,function(){return!!self[prefixed(type)]},function(){self[prefixed(type)].onReady(function(data){callback(data)})},function(){log("[DependencyManager.onReady] Max attempts to check for the instance of '"+type+"' reached.")})},ManagerPrototype.prototype.setDependency=function(type,dependencyArr){if("string"!=typeof type||!$.isArray(dependencyArr))return!1;var self=this;if(type=prefixed(type),!self[type])return!1;self[type].setDependency(dependencyArr)},ManagerPrototype.prototype.fireReady=function(type,data){if("string"!=typeof type)return!1;var self=this;type=prefixed(type),self[type]&&self[type].EVENT.fireReady(data)};var Manager=function(){var Manager=function(type,root){this.root=root,this._TYPE=type,this._DEPENDENCY=!1,this._IS_READY=!1,this._pooler={},this.EVENT=new ReadyEvent(this)};Manager.prototype.setDependency=function(dependencyArr){var self=this;if(self._DEPENDENCY)return!1;$.isArray(dependencyArr)&&isValidDependency(dependencyArr)?(self._DEPENDENCY=dependencyArr,self.isReady(),log("[DependencyManager."+self._TYPE+".setDependency] Dependency set.")):log("[DependencyManager."+self._TYPE+".setDependency] Invalid setting.")},Manager.prototype.isReady=function(){var self=this,root=this.root;if(!self._DEPENDENCY)return!1;if(self._IS_READY&&!self._pooler.isReady)return self._IS_READY;self._pooler.isReady=!0;var isReadyTrigger=function(){var x,dArr=self._DEPENDENCY,ready=!0;for(x=0;x<dArr.length;x++){var type=prefixed(dArr[x]);if(root[type]&&!root[type].EVENT.inquire()){ready=!1;break}}return ready},isReady=!1,attempts=0,pooler=function(){attempts++,isReady||(isReady=isReadyTrigger()),isReady?(self._IS_READY=!0,self._pooler.isReady=!1):attempts>360?log("[DependencyManager."+self._TYPE+".isReady] Max attempts reached to check ready state."):setTimeout(function(){pooler()},500)};pooler()},Manager.prototype.onReady=function(callback){if("function"!=typeof callback)return!1;var self=this;LoadAttempt(360,500,function(){return!!self._IS_READY},function(){callback(self._READY_DATA)})};var isValidDependency=function(arr){return!0};return Manager}(),ReadyEvent=function(){var Event=function(main){this.root=main.root,this.main=main,this._IS_READY=!1,this._READY_DATA=null};return Event.prototype.fireReady=function(data){var self=this;self._IS_READY||(self._IS_READY=!0,data&&(self._READY_DATA=data))},Event.prototype.inquire=function(){return this._IS_READY},Event}(),log=function(){if(window.console&&window.location.search.indexOf("_logs=1")>-1)try{return console.log.apply(console,arguments)}catch(err){console.log(arguments)}},prefixed=function(str){return CONST.prefix+str};return ManagerPrototype});
Modulr.define("core.plugins:ElementResizeListener",["jquery"],function($){var CONST={};CONST.eventName="Event.ResizeListener";var App=function(config){this._initialized=!1,this._elm=config.elm,this._DIM={},this._resizeBindArr=[],this.API=new API(this),$.isArray(config.min)&&(this._DIM.min=[fmtVal(config.min[0]),fmtVal(config.min[1])]),$.isArray(config.max)&&(this._DIM.max=[fmtVal(config.max[0]),fmtVal(config.max[1])]),this.init()};App.prototype.init=function(){var self=this,DIM=self._DIM,elm=self._elm;if(self._initialized)return!1;self._initialized=!0,DIM.curr=[elm.width(),getRatioHeight(elm.width(),DIM.max)],DIM.curr=setDimFromRange(DIM.curr,DIM.min,DIM.max),elm.bind(CONST.eventName,function(){for(var x=0;x<self._resizeBindArr.length;x++)self._resizeBindArr[x](self._DIM.curr)}),AddWindowResizeListener(function(){DIM.curr=[elm.width(),getRatioHeight(elm.width(),DIM.max)],DIM.curr=setDimFromRange(DIM.curr,DIM.min,DIM.max),elm.trigger(CONST.eventName)})};var API=function(){var API=function(root){this.root=root};return API.prototype.getCurrentSize=function(fn){var self=this,root=self.root,DIM=root._DIM,elm=root._elm;DIM.curr=[elm.width(),getRatioHeight(elm.width(),DIM.max)],DIM.curr=setDimFromRange(DIM.curr,DIM.min,DIM.max),"function"==typeof fn&&fn(DIM.curr)},API.prototype.onWindowResize=function(fn){var self=this,root=self.root;root._DIM,root._elm;"function"==typeof fn&&root._resizeBindArr.push(fn)},API}(),setDimFromRange=function(curr,min,max){var dim=[curr[0],curr[1]];return max&&(dim[0]=max[0]&&curr[0]<=max[0]?curr[0]:max[0]),min&&(dim[0]=min[0]&&curr[0]>=min[0]?curr[0]:min[0]),dim[1]=getRatioHeight(dim[0],max),dim},fmtVal=function(val){return"string"==typeof val&&(val=val.replace(/[^0-9]/gi,"")),val=!isNaN(val)&&parseInt(val,10)},getRatioHeight=function(w,full){var ratio=(full[0]-(full[0]-w))/full[0];return Math.floor(full[1]*ratio)},AddWindowResizeListener=function(fn){var timeout,hasOrientation="onorientationchange"in window,onEvent=hasOrientation?"orientationchange":"resize",ua=navigator.userAgent.toLowerCase(),isKindle=ua.indexOf("silk")>-1,isAndroid=ua.indexOf("android")>-1,timeoutDelay=isKindle?250:!!isAndroid&&100;$(window).bind(onEvent,function(){timeoutDelay?(clearTimeout(timeout),timeout=setTimeout(function(){fn()},timeoutDelay)):fn()})};return App});
Modulr.define("core.plugins:EventMessageHandler",function(){function log(){if(!!(window.location.search&&window.location.search.indexOf("_log=y")>-1)&&window.console)try{return console.log.apply(console,arguments)}catch(err){console.log(arguments)}}var CONST={};CONST.stringify=function(){var ver=!1;if(navigator&&"Microsoft Internet Explorer"===navigator.appName){var ua=navigator.userAgent;null!=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})").exec(ua)&&(ver=parseFloat(RegExp.$1)),ver&&ver<=9&&(ver=!0)}return ver}();var App=function(){(this.__v={})._handlers={},this.init()};return App.prototype.init=function(){var vars=this.__v;vars._messageHandler=function(event){var message=event.data,hasErr=!1;if(CONST.stringify){if(!window.JSON)return log("[EventMessageHandler.send] Requires JSON"),!1;try{message=JSON.parse(message)}catch(err){log("[EventMessageHandler.send] error:"),log(err),hasErr=!0}}if(!hasErr){log("[EventMessageHandler.receive]",message);var type=!(!message||!message.type)&&message.type,data=!(!message||!message.data)&&message.data;type&&data&&vars._handlers[type]&&"function"==typeof vars._handlers[type]&&vars._handlers[type](data)}};try{window.addEventListener("message",vars._messageHandler,!1)}catch(error){window.attachEvent("onmessage",vars._messageHandler)}this.init=function(){}},App.prototype.addHandler=function(type,callback){var self=this,vars=self.__v,prefix=vars.config&&"string"==typeof vars.config.prefix?vars.config.prefix:"";if("string"!=typeof type)return!1;type=prefix+type,vars._handlers[type]=callback},App.prototype.sendMessage=function(element,type,data){var self=this,vars=self.__v,prefix=vars.config&&"string"==typeof vars.config.prefix?vars.config.prefix:"";if("string"!=typeof type)return!1;type=prefix+type;var info={type:type,data:data};if(CONST.stringify){if(!window.JSON)return log("[EventMessageHandler.send] Requires JSON"),!1;info=JSON.stringify(info)}if(element&&"string"==typeof element&&"parent"===element)try{window.parent.postMessage(info,"*"),log("[EventMessageHandler] send to parent:",info)}catch(err){log("[EventMessageHandler.send] ERROR:",err)}else if(element&&"string"==typeof element&&"self"===element)try{window.postMessage(info,"*"),log("[EventMessageHandler] send to iframe",info)}catch(err){log("[EventMessageHandler] ERROR:",err)}else if(element&&element.contentWindow)try{element.contentWindow.postMessage(info,"*"),log("[EventMessageHandler] send to iframe",info)}catch(err){log("[EventMessageHandler] ERROR:",err)}},App});
Modulr.define("core.plugins:ExternalLink",["jquery","ENV"],function($,ENV){var App=function(){};App.prototype.set=function(elm,customLink,validate,icon){elm=elm||$("a[rel*='external']");elm.each(function(){var a=$(this),rel=$.trim(a.attr("rel")||""),href=customLink&&"string"==typeof customLink?customLink:$.trim(a.attr("href")||""),isValid=!validate||!confirmLink(href);a.attr("target");if(rel.toLowerCase().indexOf("ext-linked")<0&&href.length>0&&"#"!==href&&isValid&&(a.attr("href",href),a.attr("target")||a.attr("target","_blank"),icon)){var iconImg="//"+("qa"===ENV?"qa.":"")+"global.fncstatic.com/static/v/all/img/external-link.png";a.after('<img src="'+iconImg+'" />')}})};var confirmLink=function(val){var x,ret=!1,valid=[".foxnews.com",".foxbusiness.com"];for(x=0;x<valid.length;x+=1)if(val.indexOf(valid[x])>-1){ret=!0;break}return ret};return new App});
Modulr.define("core.plugins:HashListener",function(){var CONST={timer:500},App=function(){this.__vars={};var v=this.__vars;v._callStack=[],v._stackReady=!0,v._hashData={curr:!1,stored:!1},this.event=new Events(this),setListener(this,function(info){if(v._callStack.length<1)return!1;if(v._stackReady){v._stackReady=!1;for(var obj={str:info.curr},x=0;x<v._callStack.length;x++)v._callStack[x](obj);v._stackReady=!0}})};App.prototype.getValue=function(){return this.__vars._hashData.curr};var Events=function(){var Event=function(root){this.__vars={},this.__vars.root=root};return Event.prototype.onChange=function(callback){var self=this,root=self.__vars.root;if("function"!=typeof callback)return!1;root.__vars._callStack.push(callback)},Event}(),setListener=function(app,callback){var timer=CONST.timer,v=app.__vars,hash=v._hashData,trigger=function(){hash.curr=window.location.hash,"string"!=typeof hash.stored&&hash.curr.length>0?(hash.stored=hash.curr,callback(hash)):hash.curr!==hash.stored&&v._stackReady&&(hash.stored=hash.curr,callback(hash))};trigger(),"onhashchange"in window?window.attachEvent?window.attachEvent("onhashchange",function(){trigger()}):window.addEventListener("hashchange",function(){trigger()},!1):setInterval(function(){trigger()},timer)};return App});
Modulr.define("core.plugins:ImageLazyLoad",["require","jquery"],function(require,$){function getSrcset(info){for(var arr=info.arr,width=$w.width(),res=null,i=0;i<arr.length;i++){var item=arr[i];if(width<=item.w){res=item.src;break}}return res=res||arr[arr.length-1].src}function validateSrcset(data){if(!data)return null;for(var res=null,arr=[],str=[],items=data.split(","),i=0;i<items.length;i++){var item=$.trim(items[i]||"").replace(/\s+/g," "),sp=item.split(" ");if(2===sp.length){var w=/\w$/i.test(w)?parseInt(sp[1].replace(/\w$/i,""),10):null;"number"!=typeof w||isNaN(w)||(arr.push({src:sp[0],w:w}),str.push(item))}}return arr.length>0&&(res={str:str.join(","),arr:arr}),res}var th=300,retina=window.devicePixelRatio>1,$w=$(window),UNVEIL_STACK=[],App=function(images,threshold,callback){isNaN(threshold)||(th=threshold),images.each(function(){var elm=$(this);if("1"!==elm.attr("data-lz-init")){var srcset=elm.attr("data-srcset")||null,srcsetInfo=validateSrcset(srcset),src=function(){var res=(retina?elm.attr("data-src-retina"):elm.attr("data-src"))||elm.attr("data-src");if(srcsetInfo){var s=getSrcset(srcsetInfo);s&&(res=s)}return res}();src&&(elm.attr("data-lz-init","1"),elm.attr("data-lz-done","0"),elm.one("fnc.unveil",function(){elm.attr("data-lz-done","1");var img=new Image;elm.css({opacity:0}).attr("src",src),srcset&&elm.attr("srcset",srcset);var parent=elm.parent();"picture"===parent.prop("tagName").toLowerCase()&&parent.find("> source").each(function(){var el=$(this),ps=el.attr("data-srcset")||null;ps&&el.attr("src",ps).removeAttr("data-srcset")});var show=function(){elm.animate({opacity:1},500,"linear",function(){elm.removeAttr("data-src data-srcset"),"function"==typeof callback&&callback(elm)})};img.onload=function(){show()},img.src=elm.get(0).currentSrc||src}))}});var unveil=function(){var inview=images.filter(function(){var $e=$(this);if(!$e.is(":hidden")){var wt=$w.scrollTop(),wb=wt+$w.height(),et=$e.offset().top;return et+$e.height()>=wt-th&&et<=wb+th}}),loaded=inview.trigger("fnc.unveil");return images=images.not(loaded),images.length};UNVEIL_STACK.push(unveil),triggerStack()},triggerStack=function(){var running=!1;return function(){if(UNVEIL_STACK.length>0){if(running)return;running=!0;for(var arr=[];UNVEIL_STACK.length>0;){var fn=UNVEIL_STACK.shift();fn()&&arr.push(fn)}UNVEIL_STACK=arr,running=!1}}}();return function(){var sTimeout,rTimeout;$w.on("scroll",function(){clearTimeout(sTimeout),sTimeout=setTimeout(function(){triggerStack()},50)}),$w.resize("resize",function(){clearTimeout(rTimeout),rTimeout=setTimeout(function(){triggerStack()},50)})}(),App});
Modulr.define("core.plugins:ImageResizer",["require"],function(require){return function(url,width,height){var w=width,h=height,u=url;if(isNaN(w)||isNaN(h))return url;if(u.indexOf("a57.foxnews.com")>-1||u.indexOf("nyc.imagesizer.foxnews.com")>-1){url=u.split("/");var idx=url.length;url[idx-3]=w,url[idx-2]=h,url=url.join("/")}else{url=u.split("/");var dim="/"+w+"/"+h+"/";0!==url[0].indexOf("http")&&"//"!==u.slice(0,2)||url.splice(0,2),url.unshift("//a57.foxnews.com"),url=url.slice(0,url.length-1).join("/")+dim+url.slice(url.length-1)}return url}});
Modulr.define("core.plugins:InView",["require","OnWindowResize"],function(require,Resize){function verify(info){var uid=info.uid,target=info.target,callback=info.callback;if(isVisible(target)){callback();try{delete CALLSTACK[uid]}catch(err){CALLSTACK[uid]=null}}}function isVisible(el){return!!el.is(":visible")}function triggerStack(){for(var uid in CALLSTACK)CALLSTACK[uid]&&verify(CALLSTACK[uid])}var CALLSTACK={},ITER_UID=0;return Resize(function(){triggerStack()},5),function(target,callback){if(!target||"function"!=typeof callback)return!1;if(isVisible(target))callback();else{var uid=ITER_UID++;CALLSTACK[uid]={uid:uid,target:target,callback:callback}}}});
Modulr.define("core.plugins:InfinityLoader",["jquery"],function($){var COUNTER=0;return function(config){function checkContentViewport(){var top=win.scrollTop(),found=!1;HOLDER.children().each(function(n){var el=$(this),offset=el.offset(),winHeight=win.height(),calc=offset.top-winHeight*RATIO,count=n+1;top>=calc&&(found={target:el,details:{contentId:count,top:top,winHeight:winHeight,offset:offset,calcOffsetTop:calc}})}),found&&CURRENT_VIEW!==found.details.contentId&&(CURRENT_VIEW=found.details.contentId,setCurrentViewport(found))}function setCurrentViewport(info){for(var stack=STACK_QUEUE.onViewChange,i=0;i<stack.length;i++)stack[i](info)}function loadNext(){var stack=STACK_QUEUE.onNext;if(HOLDER.children().length>MAX_ITEMS-1){DISABLE=!0;var target=HOLDER.children(":first"),h=target.outerHeight(),top=win.scrollTop();win.scrollTop(top-h),target.remove()}for(var i=0;i<stack.length;i++)stack[i]();DISABLE=!1}COUNTER++;var Proto=this,win=$(window),doc=$(document),CURRENT_VIEW=0,INSTANCE_ID="instance-"+COUNTER,DISABLE=!1,TIMEOUT=!1,STACK_QUEUE={onNext:[],onViewChange:[]},HOLDER=config.holder,THRESHOLD=config.threshold||50,RATIO=config.viewportRatio||.5,MAX_ITEMS=config.maxItems||5;HOLDER.attr("data-set-infinite","1"),function(){win.on("scroll."+INSTANCE_ID,function(){clearTimeout(TIMEOUT),TIMEOUT=setTimeout(function(){checkContentViewport()},15),win.scrollTop()+win.height()>doc.height()-THRESHOLD&&loadNext()})}(),Proto.onNext=function(callback){STACK_QUEUE.onNext.push(function(info){callback(info)})},Proto.onViewChange=function(callback){STACK_QUEUE.onViewChange.push(function(info){callback(info)})},Proto.kill=function(){win.off("scroll."+INSTANCE_ID)}}});
Modulr.define("core.plugins:LoadAttempt",["require"],function(require){var CONST={attempts:999,timeout:500},fn=function(){},App=function(){var args=arguments,cfg=!1;isNum(args[0])&&isNum(args[1])&&isFunc(args[2])?cfg={attempts:args[0],timeout:args[1],check:args[2],success:isFunc(args[3])?args[3]:fn,expires:isFunc(args[4])?args[4]:fn}:isNum(args[0])&&isFunc(args[1])?cfg={attempts:args[0],timeout:CONST.timeout,check:args[1],success:isFunc(args[2])?args[2]:fn,expires:isFunc(args[3])?args[3]:fn}:isFunc(args[0])&&(cfg={attempts:CONST.attempts,timeout:CONST.timeout,check:args[0],success:isFunc(args[1])?args[1]:fn,expires:isFunc(args[2])?args[2]:fn});var timeout,isAbort=!1,isExpires=!1,isSuccess=!1,attempt=function(){isAbort?(clearTimeout(timeout),isExpires="aborted",cfg.expires(isExpires)):cfg.check()?(isSuccess=!0,cfg.success(),clearTimeout(timeout)):cfg.attempts>0?timeout=setTimeout(function(){attempt()},cfg.timeout):(isExpires="expired",cfg.expires(isExpires)),cfg.attempts--};return attempt(),{abort:function(){isAbort=!0},success:function(success){isSuccess?success():cfg.success=success},expires:function(expires){isExpires?expires(isExpires):cfg.expires=expires}}},isNum=function(val){return"number"==typeof val},isFunc=function(val){return"function"==typeof val};return App});
Modulr.define("core.plugins:LocationLookup",["jquery"],function($){var CONST={map:[{z:99500,s:"AK"},{z:98e3,s:"WA"},{z:97e3,s:"OR"},{z:96900,s:"XX"},{z:96700,s:"HI"},{z:96200,s:"AP"},{z:9e4,s:"CA"},{z:89e3,s:"NV"},{z:88500,s:"TX"},{z:87e3,s:"NM"},{z:85e3,s:"AZ"},{z:84e3,s:"UT"},{z:83200,s:"ID"},{z:82e3,s:"WY"},{z:8e4,s:"CO"},{z:75e3,s:"TX"},{z:73e3,s:"OK"},{z:71600,s:"AR"},{z:7e4,s:"LA"},{z:68e3,s:"NE"},{z:66e3,s:"KS"},{z:63e3,s:"MO"},{z:6e4,s:"IL"},{z:59e3,s:"MT"},{z:58e3,s:"ND"},{z:57e3,s:"SD"},{z:56900,s:"DC"},{z:55e3,s:"MN"},{z:53e3,s:"WI"},{z:5e4,s:"IA"},{z:48e3,s:"MI"},{z:46e3,s:"IN"},{z:43e3,s:"OH"},{z:4e4,s:"KY"},{z:38600,s:"MS"},{z:37e3,s:"TN"},{z:35e3,s:"AL"},{z:34e3,s:"AA"},{z:32e3,s:"FL"},{z:3e4,s:"GA"},{z:29e3,s:"SC"},{z:27e3,s:"NC"},{z:24700,s:"WV"},{z:22e3,s:"VA"},{z:20600,s:"MD"},{z:2e4,s:"DC"},{z:19700,s:"DE"},{z:15e3,s:"PA"},{z:1e4,s:"NY"},{z:7e3,s:"NJ"},{z:6e3,s:"CT"},{z:5e3,s:"VT"},{z:3900,s:"ME"},{z:3e3,s:"NH"},{z:2800,s:"RI"},{z:1e3,s:"MA"},{z:600,s:"PR"},{z:500,s:"NY"}],mapOneOff:{AK:98791,NY:6390,TN:42223,AM:96799},region:{Mountain:"AZ,CO,ID,MT,NM,NV,UT,WY",Northeast:"CT,DE,DC,MA,ME,MD,NJ,NH,NY,VT,PA,RI",West:"CA,AK,HI,OR,WA",Midwest:"IA,IL,IN,KS,MI,MN,ND,NE,OH,WI,SD,KY",South:"MO,AL,AR,LA,KT,MS,TN,TX,OK",Southeast:"VA,NC,SC,GA,FL,WV"},dma:{feed:"//www.foxnews.com/feeds/json/zip-dma/Get_AFFDMA/${zip}/all",cb:"Get_AFFDMA"}},LocationLookup=function(config){"object"==typeof config&&config.region&&(CONST.region=config.region)};LocationLookup.prototype={getByZip:function(zip){var rawZip=zip;if(!(zip=!!/(^\d{5}$)/.test(zip)&&parseInt(zip,10)))return!1;var state=getState(zip);return{zip:rawZip,state:state,region:getRegion(state)}},getByState:function(state){if("string"!=typeof state)return!1;state=state.toUpperCase();var i,region=!1;for(i in CONST.region)if(CONST.region[i].indexOf(state)>-1){region=getRegion(state);break}return!!region&&{state:state,region:region}},getByDMA:function(zip,fn){if("function"!=typeof fn)return!1;var rawZip=zip;if(!(zip=!!/(^\d{5}$)/.test(zip)&&zip))return!1;getDMA(zip,function(data){data||fn(!1),fn(!!(data.dma&&data.region&&data.city)&&{zip:rawZip,state:data.region,region:data.city,dma:data.dma})})}};var getState=function(zip){var i,map=CONST.map,oneoff=CONST.mapOneOff;for(i in oneoff)if(zip===oneoff[i])return i;for(i=0;i<map.length;i++){var item=map[i];if(zip>=item.z)return item.s}return!1},getRegion=function(state){var i,map=CONST.region;for(i in map)if(map[i].indexOf(state)>-1)return i;return!1},getDMA=function(zip,fn){var url=CONST.dma.feed;url=url.replace("${zip}",zip),$.ajax({url:url,dataType:"jsonp",jsonpCallback:CONST.dma.cb,cache:!0}).done(function(data){fn(data)})};return LocationLookup});
Modulr.define("core.plugins:MarketFutures",["require","jquery","STATIC_DOMAIN","MarketStage","EventMessageHandler"],function(require,$,DOMAIN){var MarketStage=require("MarketStage"),Event=new(require("EventMessageHandler"));return new function(){function triggerStack(){requestData(function(data){for(;READY_STACK.length>0;){READY_STACK.shift()(data)}})}function requestData(callback){var id=getCallbackId();return CALLBACK_DUMP[id]=function(data){callback(data),setTimeout(function(){try{delete CALLBACK_DUMP[id]}catch(err){CALLBACK_DUMP[id]=null}},500)},sendMessage("futures.get",{id:id}),id}function getCallbackId(){return CALLBACK_ITER++,["cb",CALLBACK_ITER].join("_")}function loadFrame(){FRAME_LOADED=!0;var src=DOMAIN+"/static/v/all/html/markets/futures/frame.html";0===$("#"+FRAME_ID).length&&$("body").append('<iframe id="'+FRAME_ID+'" src="'+src+'"></iframe>')}function sendMessage(event,data){data=data||null,Event.sendMessage(FRAME,event,data)}var Proto=this,FRAME_READY=!1,FRAME_LOADED=!1,READY_STACK=[],CALLBACK_DUMP={},CALLBACK_ITER=0,FRAME=null,FRAME_ID="ifr-mktfutures";Proto.isFutures=function(){var stage=MarketStage.getStage().stage;return 1===stage||2===stage},Proto.getData=function(callback){"function"==typeof callback&&(FRAME_LOADED||loadFrame(),FRAME_READY?requestData(callback):READY_STACK.push(callback))},Event.addHandler("futures.ready",function(){FRAME_READY=!0,FRAME=$("#"+FRAME_ID).get(0),READY_STACK.length>0&&triggerStack()}),Event.addHandler("futures.data",function(info){CALLBACK_DUMP[info.id]&&CALLBACK_DUMP[info.id](info.data)})}});
Modulr.define("core.plugins:MarketStage",["jquery","AKAMAI_TIME_HELPER"],function($,AKAMAI_TIME_HELPER){var getCurrentTime=AKAMAI_TIME_HELPER.getCurrent,CONST={holidays:{2010:{1:"1|18",2:"15",4:"2",5:"31",7:"5",9:"6",11:"25",12:"24"},2011:{1:"1|17",2:"21",4:"22",5:"30",7:"4",9:"5",11:"24",12:"25"},2012:{1:"1|16",2:"20",4:"6",5:"28",7:"4",9:"3",11:"22",12:"25"},2013:{1:"1|21",2:"18",3:"29",5:"27",7:"4",9:"2",11:"28",12:"25"},2016:{1:"1|18",2:"15",3:"25",5:"30",7:"4",9:"5",11:"24",12:"25"},2017:{1:"2|16",2:"20",4:"14",5:"29",7:"4",9:"4",11:"23",12:"25"}}},Markets=function(){this._EVENTS={}};Markets.prototype={check:function(callback){var self=this,valid=!0;self.isClose(function(data){(data.isClose||self.isHoliday(data.current))&&(valid=!1),callback(valid)})},isHoliday:function(date){var x,holidays=CONST.holidays,found=!1,toStr=function(val){return val.toString()},mm=toStr(date.getMonth()+1),dd=toStr(date.getDate()),yr=toStr(date.getFullYear());if(holidays[yr]&&holidays[yr][mm]){var obj=holidays[yr][mm],days=obj.split("|");for(x=0;x<days.length;x++)if(days[x]===dd){found=!0;break}}return found},isClose:function(callback){var self=this;"function"==typeof callback&&callback(self.getInfo())},getStage:function(date_override){var self=this,info=self.getInfo(date_override),stage=null,description="";return info.isWeekend||info.isHoliday?(stage=0,description=info.isWeekend?"CLOSED: Weekend":"CLOSED: Holiday"):!info.isClose||info.isOpenBell||info.isAfterClose?info.isClose&&info.isOpenBell&&!info.isAfterClose?(stage=2,description="CLOSED: Opening Bell (30 minutes prior to Market Opening)"):info.isClose||info.isCloseBell?!info.isClose&&info.isCloseBell?(stage=4,description="OPEN: Closing Bell (30 minutes prior to Market Closing)"):info.isClose&&info.isAfterClose&&!info.afterMarketFutures?(stage=5,description="CLOSED. Market End"):info.isClose&&info.afterMarketFutures&&(stage=6,description=" CLOSED. Market Futures"):(stage=3,description="Market is OPEN"):(stage=1,description="CLOSED: Before Opening Bell"),{stage:stage,info:info,description:description}},getInfo:function(date_override){var self=this,isClose=!1,current=date_override||getCurrentTime(),day=current.getDay(),hr=current.getHours(),mins=current.getMinutes(),milTime=(current.getSeconds(),100*hr+mins);return self.isHoliday(current)?{isHoliday:!0,isClose:!0,current:current}:0===day||6===day?{isWeekend:!0,isClose:!0,current:current}:(isClose=!(milTime>=930&&milTime<1600),{isClose:isClose,current:current,isOpenBell:milTime>=900&&milTime<930,isCloseBell:milTime>=1530&&milTime<1600,isAfterClose:milTime>=1600&&milTime<1730,isAfterMarketFutures:milTime>=1730})},setEventListeners:function(id,events){var self=this;self._EVENTS[id]?log("[Markets.Info] Event Listener ID already exists: "+id):self._EVENTS[id]=new Events(events)}};var Events=function(){var Events=function(events){this.TIMER=window.FB_MARKET_INFO?window.FB_MARKET_INFO:new Markets,this._ValidEvents="onHolidayOrWeekend|onHoliday|onWeekend|onCloseBeforeOpenBell|onCloseDuringOpenBell|onOpen|onOpenDuringCloseBell|onCloseAfterMarket|",this._Events={},this._Triggered=[],this._intervalObj=!1,this._interval=3e3,this.set(events)};return Events.prototype={set:function(events){var i,self=this,valid=self._ValidEvents;for(i in events)valid.indexOf(i+"|")>-1&&"function"==typeof events[i]&&(self._Events[i]=events[i]);events=self._Events;var hasEventTriggered=function(val){return(self._Triggered.join("|")+"|").indexOf(val+"|")>-1},setEventTrigger=function(val){self._Triggered.push(val)},trigger=function(){var stageInfo=self.TIMER.getStage(),stage=stageInfo.stage,info=stageInfo.info;switch(stage){case 0:info.isHoliday&&events.onHoliday&&!hasEventTriggered("onHoliday")?(setEventTrigger("onHoliday"),events.onHoliday(stageInfo)):info.isWeekend&&events.onWeekend&&!hasEventTriggered("onWeekend")?(setEventTrigger("onWeekend"),events.onWeekend(stageInfo)):events.onHolidayOrWeekend&&!hasEventTriggered("onHolidayOrWeekend")&&(setEventTrigger("onHolidayOrWeekend"),events.onHolidayOrWeekend(stageInfo));break;case 1:events.onCloseBeforeOpenBell&&!hasEventTriggered("onCloseBeforeOpenBell")&&(setEventTrigger("onCloseBeforeOpenBell"),events.onCloseBeforeOpenBell(stageInfo));break;case 2:events.onCloseDuringOpenBell&&!hasEventTriggered("onCloseDuringOpenBell")&&(setEventTrigger("onCloseDuringOpenBell"),events.onCloseDuringOpenBell(stageInfo));break;case 3:events.onOpen&&!hasEventTriggered("onOpen")&&(setEventTrigger("onOpen"),events.onOpen(stageInfo));break;case 4:events.onOpenDuringCloseBell&&!hasEventTriggered("onOpenDuringCloseBell")&&(setEventTrigger("onOpenDuringCloseBell"),events.onOpenDuringCloseBell(stageInfo));break;case 5:events.onCloseAfterMarket&&!hasEventTriggered("onCloseAfterMarket")&&(setEventTrigger("onCloseAfterMarket"),events.onCloseAfterMarket(stageInfo))}};trigger(),self._intervalObj=setInterval(function(){trigger()},self._interval)},removeEvents:function(){var self=this;self._intervalObj&&clearInterval(self._intervalObj)}},Events}(),log=function(str){window.console&&console.log&&console.log(str)};return new Markets});
Modulr.define("core.plugins:MarketWidget",["require","jquery","lodash","MarketFutures"],function(require,$,_){function App(){var marketHolder,Proto=this,defaultStocks=["I:COMP","SP500","I:DJI"],CALL_STACK={};Proto.init=function(opts){var self=this;if(opts&&null!==opts)for(var key in opts)this[key]=opts[key];marketHolder=opts&&opts.holder?this.holder:$("#mkt-snap .market-data .stocks"),0!==marketHolder.length&&(marketHolder.closest("#mkt-snap").length>0&&marketHolder.closest("#mkt-snap").css("display","block"),MARKET_FUTURES.isFutures()?(clearStocks.call(self,marketHolder),MARKET_FUTURES.getData(function(data){Proto.getFuturesData(marketHolder,data)}),setInterval(function(){MARKET_FUTURES.getData(function(data){Proto.getFuturesData(marketHolder,data)})},6e4)):(clearStocks.call(self,marketHolder),Proto.getMarketFeed(marketHolder),setInterval(function(){Proto.getMarketFeed(marketHolder)},6e4)),setLinks(marketHolder))},Proto.getMarketFeed=function(parent){var ticker,self=this,stock=parent.find(".stock"),stockHolder=[],futures=!!MARKET_FUTURES.isFutures();stock.each(function(){var el=$(this);ticker=el.attr("data-stock-ticker"),defaultStocks.indexOf(ticker)>-1&&futures||(stockHolder.push(ticker),checkMarketElements.call(self,el))}),Proto.getData(stockHolder,function(data){Proto.setMarketData(parent.closest(".market-data"),data,stockHolder,stock)})},Proto.getData=function(arr,callback){function loadStack(data){for(;CALL_STACK[id].length>0;)CALL_STACK[id].shift()(data)}if(arr&&callback){var id="getData"+arr.join("").replace(/[^A-Za-z0-9]+/gi,"ii");if(CALL_STACK[id])return void CALL_STACK[id].push(callback);CALL_STACK[id]=[],CALL_STACK[id].push(callback);var url="//www.foxbusiness.com/ajax/quote/"+arr.join(",");$.ajax({url:url,data:{cb:cacheBuster(2)},dataType:"jsonp",jsonpCallback:id,async:!0,cache:!0}).done(function(data){loadStack(data)})}},Proto.setMarketData=function(el,data,stockArr,stocksEl){var self=this,marketInfo=normalize(data,stockArr);stocksEl.each(function(){var $self=$(this),current=$self.find(".current"),name=$self.find(".name"),change=$self.find(".change"),percent=$self.find(".percent"),headerName=$self.find("a"),headerPercent=headerName.find("span"),ticker=$self.attr("data-stock-ticker"),titleOverride=$self.attr("data-stock-title");void 0!==marketInfo[ticker]&&(self.header?(getText(headerName)!==marketInfo[ticker].name&&(clearText(headerName),headerName.prepend(marketInfo[ticker].name+" ")),headerPercent.text(marketInfo[ticker].percentChange)):(name.html(marketInfo[ticker].name),current.html(marketInfo[ticker].current),change.html(marketInfo[ticker].netChange),percent.html(marketInfo[ticker].percentChange),""!==titleOverride&&name.html(titleOverride)),checkPosNegVal.call(self,self.header?el.find("ul"):el.find(".stocks")))})},Proto.getFuturesData=function(el,data){var self=this;el.find(".stock").each(function(){var stock=$(this),sym=stock.attr("data-stock-ticker");checkMarketElements.call(self,$(this)),defaultStocks.indexOf(sym)>-1?(Proto.setFuturesData(stock,sym,data),checkPosNegVal.call(self,null,stock)):Proto.getMarketFeed(el)})},Proto.setFuturesData=function(stock,sym,data){function idx(val,obj){return obj.name.indexOf(val)>-1}function setValues(obj){self.header?stock.find("a > span").text(obj.pct):(stock.find(".percent").html(obj.pct),stock.find(".current").html(obj.val),stock.find(".change").html(obj.pts))}var self=this;self.header?_(data).forEach(function(obj){idx("E-MINI DOW",obj)&&"I:DJI"===sym?("DJIA"!==getText(stock.find("a"))&&(clearText(stock.find("a")),stock.find("a").prepend("DJIA ")),setValues(obj)):(idx("E-MINI S&P 500",obj)||idx("E-MINI S&amp;P 500",obj))&&"SP500"===sym?("S&P 500"!==getText(stock.find("a"))&&(clearText(stock.find("a")),stock.find("a").prepend("S&P 500 ")),setValues(obj)):idx("E-MINI NASDAQ",obj)&&"I:COMP"===sym&&("NASDAQ"!==getText(stock.find("a"))&&(clearText(stock.find("a")),stock.find("a").prepend("NASDAQ 100".replace(/\d+/g,""))),setValues(obj))}):_(data).forEach(function(obj){idx("E-MINI DOW",obj)&&"I:DJI"===sym?(stock.find(".name").html("DJIA"),setValues(obj)):idx("E-MINI S&P 500",obj)&&"SP500"===sym?(stock.find(".name").html("S&P 500"),setValues(obj)):idx("E-MINI NASDAQ",obj)&&"I:COMP"===sym&&(stock.find(".name").html("NASDAQ 100".replace(/ \d+/g,"")),setValues(obj))})}}function checkMarketElements(el){var self=this,marketTemplate=self&&self.header?'<a href="#"><span class=""></span></a>':'<span class="name"></span>                <span class="current"></span>                <span class="change"></span>                <span class="percent"></span>';(!self.header&&0===el.find(".name").length||self.header&&0===el.find("a").length)&&el.append(marketTemplate)}function checkPosNegVal(el,stock){var self=this;(stock&&stock.length>0?stock:el.find(".stock")).each(function(){var $self=$(this),$pctEl=self.header?$self.find("a span"):$self.find(".percent"),pct=$pctEl.text();self.header?($pctEl.removeClass("pos neg"),/\+/.test(pct)?$pctEl.addClass("pos"):$pctEl.addClass("neg")):($self.removeClass("pos neg"),/\+/.test(pct)?$self.addClass("pos"):$self.addClass("neg"))})}function cacheBuster(freq){freq=freq||!1;var date=new Date,str=date.getFullYear().toString()+(date.getMonth()+1).toString()+date.getDate().toString(),hr=date.getHours()+1,min=date.getMinutes();return str+=hr.toString()+(freq&&!isNaN(freq)?Math.floor(min/parseInt(freq,10)).toString():"")}function renameTicker(sym,desc){if("Crude Oil"===desc)return sym="FUT-CL";switch(sym){case"I:DJI":sym="DJIA";break;case"I:COMP":sym="NASDAQ";break;case"SP500":sym="S&P 500";break;case"FUT-GC":sym="GOLD";break;case"CLU16":case"CLV16":sym="FUT-CL"}return sym}function normalize(data,stockArr){var quoteBase,symbol,quotes=$.isArray(data.quote)?data.quote:[data.quote],i=0,info={};for(stockArr=stockArr||[],i;i<quotes.length;i++)quoteBase=quotes[i],symbol=quoteBase.ticker,desc=quoteBase.description,(["CLU16","CLV16"].indexOf(symbol)>-1||"Crude Oil"===desc)&&(symbol=renameTicker(symbol,desc)),"n.a."!==symbol&&(info[symbol]={},info[symbol].current=quoteBase.current,info[symbol].percentChange=quoteBase.percentChange,info[symbol].netChange=quoteBase.netChange,info[symbol].name=renameTicker(symbol,desc));return info}function clearStocks(el){var self=this;el.find(".stock").each(function(){var stock=$(this);0!==stock.children().length&&(self&&self.header?clearText(stock.find("a > span")):stock.find(".name, .current, .change, .percent").empty())})}function clearText($el){$el.contents().filter(function(){return 3===this.nodeType}).remove()}function setLinks(el){el.find(".stock").each(function(){var stock=$(this),sym=stock.attr("data-stock-ticker"),link="//www.foxbusiness.com/quote.html?stockTicker="+sym;void 0!==stock.attr("data-stock-url")&&""!==stock.attr("data-stock-url")&&(link=stock.attr("data-stock-url")),stock.on("click",function(evt){evt.preventDefault(),link&&window.open(link,"_blank")})})}function getText($el){var text=$el.contents().filter(function(){return 3===this.nodeType})[0];return!!text&&text.nodeValue}var MARKET_FUTURES=require("MarketFutures");return new App});
Modulr.define("core.plugins:MediaIconOverlay",["jquery"],function($){var CONST={},domain=window.FOX_ENV_STATIC_DOMAIN;CONST.domain=domain,CONST.size=[118,96,64,48,32,24,16],CONST.type={video:{type:"video",image:"/static/v/all/img/vd-overlay_${dim}.png"},video2:{type:"video2",image:"/static/v/all/img/vid2_${dim}.png"},slideshow:{type:"slideshow",image:"/static/v/all/img/ss-overlay_${dim}.png"},slideshow2:{type:"slideshow2",image:"/static/v/all/img/slid2_${dim}.png"},interactive:{type:"interactive",image:"/static/v/all/img/ia-overlay_${dim}.png"},freeform:{type:"interactive",image:"/static/v/all/img/ia-overlay_${dim}.png"},magnify:{type:"magnify",image:"/static/v/all/img/mg-overlay_${dim}.png"},listpage:{type:"listpage",image:"/static/v/all/img/lp-overlay_${dim}.png"},"list-article":{type:"listpage",image:"/static/v/all/img/lp-overlay_${dim}.png"}};var App=function(){};App.prototype.embed=function(config){var target=config.target,dim=(target.parent(),config.dim||!1),type=config.type;if(!target.attr("src"))return!1;if(!CONST.type[type])return!1;var trigger=function(){dim?setEmbed(config,dim):getDimensions(config,function(info){setEmbed(config,info)})},lazyImg=isLazyLoad(target);if(lazyImg){var lazyLoopIntv=!1,lazyLoop=function(){target.attr("src")===lazyImg?(trigger(),clearTimeout(lazyLoopIntv)):lazyLoopIntv=setTimeout(function(){lazyLoop()},800)};lazyLoop()}else trigger()};var setEmbed=function(config,dim){var target=config.target,parent=target.parent(),type=config.type,position=getPos(type,target)||config.position||"bottom right",size=config.size||getSize(config,dim),edge=config.edge||getEdge(position,dim,size),responsive=config.responsive||!1,typeInfo=CONST.type[type];if(parent.hasClass("overlay-media")&&parent.attr("data-ovr"))return!1;var html=$('<div class="overlay-media" data-ovr="1"></div>');responsive?html.css({position:"relative"}):html.css({width:dim[0],height:dim[1],position:"relative"});var overlay=$('<div class="ovr ovr-'+size+'"></div>'),overlayImg=CONST.domain+typeInfo.image.replace("${dim}",size),css={background:"url('"+overlayImg+"') no-repeat center center",position:"absolute",width:size,height:size,"background-position":"0px 0px","z-index":1,opacity:0,"-webkit-transition":"opacity 0.3s","-moz-transition":"opacity 0.3s","-o-transition":"opacity 0.3s",transition:"opacity 0.3s"};switch(position){case"bottom left":css.left=edge[0]+"px",css.bottom=edge[1]+"px";break;case"top right":css.right=edge[0]+"px",css.top=edge[1]+"px";break;case"top left":case"center":css.left=edge[0]+"px",css.top=edge[1]+"px";break;default:css.right=edge[0]+"px",css.bottom=edge[1]+"px"}overlay.css(css),html.append(overlay),html.append(target.clone()),target.replaceWith(html),setTimeout(function(){parent.find(".ovr").css("opacity","1"),parent.find(".overlay-media").hover(function(){$(this).find(".ovr").css("background-position","0px -"+size+"px")},function(){$(this).find(".ovr").css("background-position","0px 0px")})},150),"function"==typeof config.onDone&&config.onDone()},isLazyLoad=function(elm){return elm.attr("data-src")||elm.attr("dest_src")||!1},getDimensions=function(config,callback){var target=config.target,img=new Image,src=target.attr("src");return img.onload=function(){var dim=[target.width(),target.height()];callback(dim)},img.src=src,!1},getEdge=function(position,dim,size){var ratio=[.05,.05];return"center"===position?[Math.floor(.5*dim[0]-.5*size),Math.floor(.5*dim[1]-.5*size)]:[Math.floor(dim[0]*ratio[0]),Math.floor(dim[1]*ratio[1])]},getSize=function(config,dim){var x,w=Math.floor(.16*dim[0]),ret=!1;if(map=CONST.size,!isNaN(w))if(w>=map[0]&&(ret=map[0]),w<=20)ret=map[map.length-1];else for(x=0;x<map.length;x++){var val=map[x],nVal=map[x+1]?map[x+1]:0,diffH=Math.abs(val-w),diffL=Math.abs(val-nVal);if(w<=val&&w>nVal){ret=diffH>diffL?nVal:val;break}}return ret||!1},getPos=function(type,target){return window._FOX_ABT&&window._FOX_ABT.videoPlayBtnPos&&"video"===type?window._FOX_ABT.videoPlayBtnPos:target.attr("data-ovr-pos")||!1};return App});
Modulr.define("core.plugins:MobileAppLauncher",["jquery"],function($){var isDevice=/android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini/i.test(navigator.userAgent.toLowerCase()),App=function(){};App.prototype.init=function(){var self=this;$(".mobile-app").find("a").on("click",function(evt){evt.preventDefault(evt);var el=$(this),platform=el.attr("data-platform"),urlScheme=el.attr("data-url-scheme"),webUrl=el.attr("href"),data={platform:platform,urlScheme:urlScheme,webUrl:webUrl,device:self.getDevice()};return isDevice?self.openNative(data):window.location=webUrl,!1})},App.prototype.getDevice=function(){return navigator.userAgent.match(/iPhone|iPad|iPod/i)?"ios":navigator.userAgent.match(/Android/i)?"android":navigator.userAgent.match(/BlackBerry/i)?"blackberry":navigator.userAgent.match(/Opera Mini/i)?"opera":navigator.userAgent.match(/IEMobile/i)?"windows":"other"},App.prototype.openNative=function(data){var clicked=+new Date;data.platform===data.device?window.location=data.urlScheme:window.location=data.webUrl,setTimeout(function(){+new Date-clicked<200&&(target=data.urlScheme),setTimeout(function(){+new Date-clicked<200&&(window.location="http:"+data.webUrl)},100)},100)};var APP=new App;return function(){APP.init()}});
Modulr.define("core.plugins:MultiFeedParser",["jquery"],function($){var CONST={logName:"[Feed Parser]",jsonpParam:"callback",minRefreshRate:.3},App=function(config){config=config||{};var self=this;self.__vars={};var v=self.__vars;v._config=config,v._fn={},v._data={},v._xhr={},v._callStack={},v._initExe={},v._refreshObj={},self.event=new Events(self),v._fn.log=v._config.logging?log:function(){};var i,initOnLoad=!("boolean"==typeof v._config.initOnLoad&&!v._config.initOnLoad),feeds=!(!v._config||!v._config.feeds)&&v._config.feeds;if(initOnLoad&&feeds)for(i in feeds)loadFeed(v,i),feeds[i].refresh&&setRefreshRate(self,i,feeds[i])},Events=function(){var Event=function(root){this.__vars={},this.__vars.root=root};return Event.prototype.reload=function(types){var i,x,self=this,root=self.__vars.root,v=root.__vars,feeds=!(!v._config||!v._config.feeds)&&v._config.feeds,arr=[];if(!feeds)return!1;var setRefresh=function(type){v._refreshObj[type]||setRefreshRate(root,type,feeds[type])};if("string"==typeof types&&(types=trimStr(types).replace(/\s+/g," "),arr=types.split(" ")),arr.length>0)for(x=0;x<arr.length;x++)feeds[arr[x]]&&(v._fn.log(CONST.logName+" Reloading {type}: '"+arr[x]+"'"),loadFeed(v,arr[x]),setRefresh(arr[x]),!0);else{v._fn.log(CONST.logName+" Reloading all feed {type}");for(i in feeds)loadFeed(v,i),setRefresh(i);!0}},Event.prototype.addFeed=function(){var self=this,root=self.__vars.root,v=root.__vars,feeds=v._config&&v._config.feeds?v._config.feeds:{},args=arguments,config={type:!1,url:!1};if("string"==typeof args[0]&&"string"==typeof args[1]?(config.type=args[0],config.url=args[1]):"object"==typeof args[0]&&args[0].type&&args[0].url&&(config=args[0]),!config.type||!config.url)return v._fn.log(CONST.logName+" Cannot fire event.addFeed(). Missing config {type} or {url}."),!1;if(feeds[config.type])return v._fn.log(CONST.logName+" Cannot fire event.addFeed() for {type}: '"+config.type+"'. This type already exists."),!1;var i,cfg={};for(i in config)"type"!==i&&(cfg[i]=config[i]);root.__vars._config.feeds||(root.__vars._config.feeds={}),root.__vars._config.feeds[config.type]=cfg,loadFeed(v,config.type),config.refresh&&setRefreshRate(root,config.type,cfg)},Event.prototype.removeFeed=function(type){var self=this,root=self.__vars.root;root.__vars;if(!root.__vars._config||!root.__vars._config.feeds||"string"!=typeof type)return!1;type=trimStr(type).replace(/\s+/g," ");type.split(" ")},Event.prototype.onLoad=function(){var self=this,root=self.__vars.root,v=root.__vars,feeds=v._config&&v._config.feeds?v._config.feeds:{},args=setLoaderArgs(arguments);if(!args.type||!args.callback||!feeds[args.type])return!1;var type=args.type,callback=args.callback;v._callStack[type]||(v._callStack[type]=[]),v._callStack[type].push(callback),v._initExe[type]&&callback(v._data[type])},Event.prototype.getData=function(){var self=this,root=self.__vars.root,v=root.__vars,args=(v._config&&v._config.feeds&&v._config.feeds,setLoaderArgs(arguments));if(!args.type||!args.callback)return!1;var timeoutObj,type=args.type,callback=args.callback,cntr=0,attempt=function(){void 0!==v._data[type]?callback(v._data[type]):cntr<=120&&(clearTimeout(timeoutObj),timeoutObj=setTimeout(function(){attempt()},250),cntr++)};attempt()},Event}(),setRefreshRate=function(self,type,info){if(!isNaN(info.refresh)){var config=self.__vars._config,refresh=!1;if(config.ignoreMinRefreshRate?refresh=info.refresh.toFixed(2):parseFloat(info.refresh)>=CONST.minRefreshRate&&(refresh=info.refresh.toFixed(2)),!refresh)return log(CONST.logName+" Warning: Cannot set refresh for {type}: '"+type+"' refresh rate less than minimum rate allowed."),!1;refresh*=6e4,clearInterval(self.__vars._refreshObj[type]),self.__vars._refreshObj[type]=setInterval(function(){self.event&&"function"==typeof self.event.reload?self.event.reload(type):log(CONST.logName+" Warning: Cannot find event.reload(). Reload for {type}: '"+type+"' not fired.")},refresh)}},loadFeed=function(vars,type){function commonSuccessFN(data){var normFN=getNormalizationFN(info.normalize,feeds),normalized=normFN?normFN(data):data;log(CONST.logName+" Loaded Feed for {type}: '"+type+"'"),vars._data[type]=normalized,vars._initExe[type]||(vars._initExe[type]=!0),triggerStack(vars._callStack[type],vars._data[type])}var feeds=vars._config.feeds,info=feeds[type]||!1;if(!info)return!1;var url=function(){var ret=!1;return"string"==typeof info?ret=info:info.url&&(ret=info.url),ret}();if(!url)return log(CONST.logName+" URL not defined for feed {type}: '"+type+"'"),!1;var dataType=function(){var ret="json",jsonpCallback=getJSONP(url);return"string"==typeof info.jsonpCallback||jsonpCallback?ret="jsonp":info.type&&inDataType(info.type)&&(ret=info.type),ret=ret.toLowerCase()}(),ajaxConfig={};switch(dataType){case"json":ajaxConfig={dataType:"json",cache:!0,async:!0,success:function(data){commonSuccessFN(data)}};break;case"jsonp":var urlCallback=getJSONP(url),callback=useJSONPCallback(type,"string"==typeof info.jsonpCallback&&info.jsonpCallback,urlCallback);window[callback.name]=function(data){commonSuccessFN(data)},ajaxConfig={dataType:"script",async:!0,cache:!0},urlCallback||(ajaxConfig.data={},ajaxConfig.data[callback.param]=callback.name)}if(ajaxConfig.url=url,function(){var cacheTime;"function"==typeof vars._config.cacheStrFN?(cacheTime=vars._config.cacheStrFN())&&(ajaxConfig.data||(ajaxConfig.data={}),ajaxConfig.data.cb=cacheTime):(cacheTime=!(!vars._config.cacheTime||isNaN(vars._config.cacheTime))&&parseFloat(vars._config.cacheTime))&&(ajaxConfig.data||(ajaxConfig.data={}),ajaxConfig.data.cb=cacheBuster(cacheTime))}(),"jsonp"!==dataType&&vars._xhr[type])try{"function"==typeof vars._xhr[type].abort&&vars._xhr[type].abort()}catch(err){}vars._xhr[type]=$.ajax(ajaxConfig)},triggerStack=function(stack,data){if(!isArray(stack))return!1;for(var x=0;x<stack.length;x++)"function"==typeof stack[x]&&stack[x](data)},setLoaderArgs=function(args){var type=!1,callbackFN=!1;return"string"==typeof args[0]?type=args[0]:"object"!=typeof args[0]||isArray(args[0])||(type=!!args[0].type&&args[0].type),"function"==typeof args[1]&&(callbackFN=args[1]),{type:type,callback:callbackFN}},getNormalizationFN=function(val,feeds){var i,ret=!1;if("function"==typeof val)ret=val;else if("string"==typeof val)for(i in feeds)if(val===i&&"function"==typeof feeds[i].normalize){ret=feeds[i].normalize;break}return ret},useJSONPCallback=function(type,opt1,opt2){var ret={param:"callback"};if(opt1&&2===opt1.split("=").length){var sp=opt1.split("=");ret.param=sp[0],ret.name=sp[1]}else ret.name=opt1||(opt2||"jsonp"+type);return ret},inDataType=function(type){var x,types=["jsonp","json","xml","html","text","script"];for(x=0;x<types.length;x++)if(types[x]===type.toLowerCase()){!0;break}},getJSONP=function(url){var x,ret=!1,sp=url.split("?"),search=sp[1];if(search){var arr=search.toLowerCase().indexOf(CONST.jsonpParam+"=")>-1?search.split("&"):[];for(x=0;x<arr.length;x++){var pair=arr[x].split("=");if(pair[0].toLowerCase()===CONST.jsonpParam){ret=decodeURI(pair[1]);break}}}return ret},log=function(){if(window.console)try{return console.log.apply(console,arguments)}catch(err){console.log(arguments)}},cacheBuster=function(freq){freq=freq||!1;var date=window.AKAMAI_TIME_HELPER&&"function"==typeof AKAMAI_TIME_HELPER.getCurrent?AKAMAI_TIME_HELPER.getCurrent():new Date,str=date.getFullYear().toString()+(date.getMonth()+1).toString()+date.getDate().toString(),hr=date.getHours()+1,min=date.getMinutes();return str+=hr.toString()+(freq&&!isNaN(freq)?Math.floor(min/parseFloat(freq)).toString():"")},isArray=function(val){return val=val||!1,"[object Array]"===Object.prototype.toString.call(val)},trimStr=function(val){return val=(val||"").replace(/^\s+|\s+$/g,"")};return App});
Modulr.define("core.plugins:NewslettersForm",["jquery","ISA"],function($,ISA){var CONST={};CONST.SLID={FB_Breaking_Alerts:"5C84B893BD6D939E84FAE1A8E6E9525A",FB_CEO_Newsbrief:"3DC725E303A24F8D870B96401050B31F",FB_Morning_Headlines:"3DC725E303A24F8D518A0FB222399489",FB_Most_Popular_Content:"3DC725E303A24F8D39740C7B45D15F45",FB_Small_Business_Weekly_Report:"3DC725E303A24F8D3540B4B6FB335FC8",FB_Stock_Alerts:"",FB_The_Willis_Report_Promotional:"3DC725E303A24F8D5E4CD875B68955A6",FB_Weekly_Personal_Finance:"3DC725E303A24F8D7E5F3A553E2E6154",FB_Claman_On_Call:"3DC725E303A24F8D12785ABB73469705",FN_Autos:"3DC725E303A24F8D197DA3C8590F80E2",FN_Breaking_Alerts:"C2F278094FACCEA62391025B7A52D8EB",FN_Food_And_Drink:"3DC725E303A24F8D1C12D1E24CDEA25E",FN_FOX_411_Newsletter:"3DC725E303A24F8D9C92271F5026F381",FN_FOX_411_Partner_Pitch_Email:"3DC725E303A24F8DD2821C1AF73D49D4",FN_Health_Newsletter:"3DC725E303A24F8DA5DBC7FFD49BC2B8",FN_Leisure_Headlines:"3DC725E303A24F8D02B1F9D9AAF16982",FN_Monthly_Politics_Update:"3DC725E303A24F8D836CEAE9B885C87D",FN_Morning_Headlines:"3DC725E303A24F8DCF015F07C61BABFD",FN_Most_Popular:"3DC725E303A24F8DB05092D232355E43",FN_Opinion_Headlines:"3DC725E303A24F8D95ACD1C9C0564C20",FN_Politics:"3DC725E303A24F8DA102192D9D5143D9",FN_Promotional_Emails:"3DC725E303A24F8D41CEA8699C0FE71E",FN_Science_And_Technology:"3DC725E303A24F8DAB69E1C048904762",FN_Weekly_Travel:"3DC725E303A24F8DE5173CCC4F027046",Fox_Nation_Fired_Up:"3DC725E303A24F8D64B4C05965F09E1A",uReport_Launch_Email:"3DC725E303A24F8D41CEA8699C0FE71E",uReport_Monthly:"3DC725E303A24F8D41CEA8699C0FE71E",FN_Latino_Morning_Headlines:"3DC725E303A24F8D555BC7C7F3FD748B"},CONST.defaultStr="Enter Email Address";var App=function(config){var self=this,elm=config.elm;self._elm=elm,self._SLID=config.SLID?config.SLID:elm.find("input[type='hidden'][name='slid']").val(),self._INPUT=config.INPUT?config.INPUT:elm.find("input[type='text'][name='signup']"),self._INPUT_STR=config.INPUT_STR?config.INPUT_STR:CONST.defaultStr,self._onSuccess="function"==typeof config.onSuccess?config.onSuccess:function(){},self._onError="function"==typeof config.onError?config.onError:function(){},self._onFocus="function"==typeof config.onFocus?config.onFocus:function(){},self._onBlur="function"==typeof config.onBlur?config.onBlur:function(){},"3DC725E303A24F8D9C92271F5026F381"===self._SLID&&(self._INPUT_STR="Enter your email address"),self._INPUT.val(self._INPUT_STR),setFocus(self._INPUT,self._INPUT_STR,self._onFocus,self._onBlur),elm.submit(function(){return self.submit(),!1})};App.prototype.submit=function(){var self=this;if(self._submitting)return!1;self._submitting=!0;var elm=self._elm,email=self._INPUT.val().trim(),SLID=self._SLID,valid=isValidEmail(email);if(valid&&SLID)self._onSuccess(),sendSubscription(email,SLID,elm);else{var err=valid?"slid":"email";self._onError(err)}return setTimeout(function(){self._submitting=!1},500),!1};var setFocus=function(input,str,onFocus,onBlur){input.focus(function(){var val=$(this).val();$.trim(val.toLowerCase())===str.toLowerCase()&&$(this).val(""),onFocus()}),input.blur(function(){var val=$(this).val();""===$.trim(val.toLowerCase())&&$(this).val(str),onBlur()})},sendSubscription=function(email,SLID,elm){var list=elm.attr("data-list")||"email-sign-up-success";$.ajax({type:"POST",url:"/portal/newsalertsubscribe",data:{slids:SLID,email:email,format:"html"},dataType:"text"}).done(function(){ISA.track({"email-sign-up-success":{listName:list}})})},isValidEmail=function(email){return!!/^[\w-]+(?:\.[\w-]+)*@(?:[\w-]+\.)+[a-zA-Z]{2,7}$/i.test(email)};return App});
Modulr.define("core.plugins:OnScroll",["jquery"],function($){return function(callback,threshold){function getDir(val){return val>curr?"down":"up"}if(threshold="number"!=typeof threshold?25:threshold,"function"!=typeof callback||!$)return!1;var timeout,win=$(window),curr=win.scrollTop(),set=function(){var val=win.scrollTop(),dir=getDir(val);curr=val,callback(dir)};win.bind("scroll",function(){0===threshold?set():(clearTimeout(timeout),timeout=setTimeout(function(){set()},threshold))})}});
Modulr.define("core.plugins:OnWindowResize",["jquery"],function($){return function(callback,threshold){if(threshold="number"!=typeof threshold?25:threshold,"function"!=typeof callback||!$)return!1;var timeout,hasOrientation="onorientationchange"in window,onEvent=hasOrientation?"orientationchange":"resize";$(window).bind(onEvent,function(){clearTimeout(timeout),timeout=setTimeout(function(){callback()},threshold)})}});
Modulr.define("core.plugins:OutbrainWidgetConnector",["jquery"],function($){var CONST={OBVar:"OB_elements",src:window.location.protocol+"//widgets.outbrain.com/outbrain.js",legacySrc:window.location.protocol+"//widgets.outbrain.com/outbrainWidget.js",langJS:window.location.protocol+"//widgets.outbrain.com/lang_en.js"},App=function(config){if(!config)return!1;this.addWidget(config)};App.prototype.addWidget=function(config,callback){var x;if(!config)return!1;window[CONST.OBVar]||(window[CONST.OBVar]=[]);var conf=setConfig(config);for(x=0;x<conf.length;x++){var cf=conf[x],modify=!cf.addWidgetType||"data-widget"!==cf.addWidgetType,containerEl=$("#"+cf.containerId);0===containerEl.length&&(containerEl=$('.OUTBRAIN[data-widget-id="'+cf.widgetId+'"]')),containerEl.is(":visible")?(cf.langJS=cf.langJS||CONST.langJS,cf.permalink=setPermaLink(cf.permalink),containerEl.attr("data-src",cf.permalink),modify&&(modifyContainer(containerEl),window[CONST.OBVar].push(cf)),cf.overlayDim&&setOverlay(cf.widgetId,cf.overlayDim)):containerEl.remove()}triggerScript(callback)},App.prototype.refreshWidgets=function(permaLink){if(!window.OBR)return!1;permaLink=permaLink||null;try{window.OBR.extern.refreshWidget(permaLink)}catch(err){}},App.prototype.addWidgetLegacy=function(config,callback){config=isArray(config)?config[0]:config,config.containerId&&modifyContainer($("#"+config.containerId)),config.permalink=setPermaLink(config.permalink),window.OB_permalink=config.permalink,window.OB_widgetId=config.widgetId,window.OB_Template=config.Template,window.OB_langJS=config.langJS||CONST.langJS,window.OB_isLateStarter=!0,triggerScript(callback,!0),config.overlayDim&&setOverlay(config.widgetId,config.overlayDim)};var triggerScript=function(callback,legacy){if(callback="function"==typeof callback?callback:function(){},window.OB_Script&&window.OutbrainStart)try{window.OutbrainStart(),callback()}catch(err){log("[Outbrain.Connector] Error: "+err)}else{var s=document.getElementsByTagName("script")[0],ob=document.createElement("script");ob.type="text/javascript",ob.onreadystatechange=ob.onload=function(){window.OB_Script=!0,callback()},ob.async=!0,ob.src=legacy?CONST.legacySrc:CONST.src,s.parentNode.insertBefore(ob,s)}},setOverlay=function(id,dim){dim=dim||"32";var overlayMarkup='<div class="media-overlay" style="position: absolute; bottom: 8px; width: '+dim+"px; min-height: "+dim+"px; background: url('//global.fncstatic.com/static/v/all/img/vd-overlay_"+dim+".png') no-repeat scroll 0px 0px transparent; right: 8px;\"></div>",check=function(){return $("div[data-widget-id='"+id+"'] .ob-rec-link-img").length>0},trigger=function(){setTimeout(function(){$("div[data-widget-id='"+id+"'] .ob-rec-link-img").each(function(){var el=$(this);if(el.find(".ob_video").length>0){el.prepend(overlayMarkup);var overlay=el.find("> .media-overlay");el.hover(function(){overlay.css("background-position","0px -"+dim+"px")},function(){overlay.css("background-position","0px 0px")})}})},100)};if($.loadAttempt)$.loadAttempt(25,250,function(){return check()},function(){trigger()});else{var timeoutObj=!1,cntr=0,timeoutFn=function(){check()?trigger():cntr<=25&&(cntr++,timeoutObj=setTimeout(function(){timeoutFn()},250))};timeoutFn()}},modifyContainer=function(container){container.addClass("OBR"),container.attr("data-fbk")||container.attr("data-fbk","1")},setConfig=function(info){return info&&!isArray(info)&&(info=[info]),info},setPermaLink=function(permalink){var loc=window.location;loc.host||loc.hostname;return permalink},isArray=function(val){return val=val||!1,"[object Array]"===Object.prototype.toString.call(val)};return App});
Modulr.define("core.plugins:Paginator",function(){function getPageList(curr,max,pages){var x,len,pgArr=[];for(len=curr-Math.floor(pages/2),len=len<1?1:len,x=curr;x>=len;x--)pgArr.push(x);pgArr.reverse();var left=pages-pgArr.length;if(curr<max)for(len=curr+left,len=len>max?max:len,x=curr+1;x<=len;x++)pgArr.push(x);if(pgArr.length<pages&&1!==pgArr[0]){len=pages-pgArr.length,len=len<1?1:len,pgArr.reverse();var last=pgArr[pgArr.length-1];for(x=0;x<len&&!((last-=1)<1);x++)pgArr.push(last);pgArr.reverse()}return pgArr}return function(curr,max,pages){pages=pages||10;var list=getPageList(curr,max,pages);list[0],list[list.length-1];return{list:list,first:list[0],last:list[list.length-1],prev:curr-1<1?1:curr-1,next:curr+1>max?max:curr+1,current:curr,max:max}}});
Modulr.define("core.plugins:SchedulePromo",["jquery","MultiFeedParser","DateTime"],function($,MultiFeedParser,DateTime){var CONST={};CONST.feed={schedule:"//www.foxnews.com/feeds/schedule/channel/fox-news/feed/json",promo:"//www.foxnews.com/feeds/schedule/channel/fox-news/promotions/feed/json"},CONST.imgSize=[171,96];var App=function(){this._feedRequested=!1,this._DATA={},this.API=new API(this)};App.prototype.getData=function(callback){var self=this;self._DATA.schedule&&self._DATA.promo?callback(self._DATA):self._feedRequested?$.loadAttempt(100,150,function(){return!(!self._DATA.schedule||!self._DATA.promo)},function(){callback(self._DATA)}):self.getFeed(callback)},App.prototype.getFeed=function(callback){var self=this;self._feedRequested=!0;var config={};config.feeds={},config.logging=!0,config.initOnLoad=!0,config.feeds.schedule={url:CONST.feed.schedule,jsonpCallback:"FOX_ShowHeaderSchedule"},config.feeds.promo={url:CONST.feed.promo,jsonpCallback:"FOX_ShowHeaderPromo"};var parser=new MultiFeedParser(config);self._parser=parser,parser.event.onLoad("schedule",function(schedData){self._DATA.schedule=schedData,parser.event.onLoad("promo",function(promoData){self._DATA.promo=promoData,self._DATA=Normalize.feed(self._DATA),callback(self._DATA)})})};var API=function(){var API=function(root){this.root=root};return API.prototype.getCurrentSchedule=function(callback){this.root.getData(function(data){var ret=!!(data&&data.schedule&&data.schedule.current)&&Normalize.schedule(data.schedule.current);callback(ret)})},API.prototype.getCurrentPromo=function(callback){this.root.getData(function(data){var ret=!!(data&&data.promo&&data.promo.current)&&Normalize.promo(data.promo.current);callback(ret)})},API.prototype.getLatest=function(callback){var self=this,trigger=(self.root,function(data){var info=(data.promo?data.promo:data.schedule,!1);data.promo?info={type:"promo",data:data.promo}:data.schedule&&(info={type:"schedule",data:data.schedule}),callback(info)});self.getCurrentSchedule(function(sched){self.getCurrentPromo(function(promo){trigger({schedule:sched,promo:promo})})})},API}(),Normalize=function(){var Normalize={};return Normalize.feed=function(data){var schedule=!(!data.schedule||!$.isArray(data.schedule.day))&&data.schedule,currentDateTime=(data.promo,AKAMAI_TIME_HELPER.getCurrent());if(!schedule)return!1;$.isArray(data.promo.promotion)||(data.promo.promotion=[data.promo.promotion]);var currentSchedShow=getCurrentSchedule(currentDateTime,data.schedule.day),currentPromoShow=!(!data.promo||!data.promo.promotion.length)&&getCurrentPromo(currentDateTime,data.promo.promotion),normalized={};return normalized.schedule={raw:data.schedule,current:currentSchedShow||!1},normalized.promo={raw:data.promo,current:currentPromoShow||!1},normalized},Normalize.schedule=function(data){var dim=CONST.imgSize,info={};return info.title=setValidStr(data.title)||setValidStr(data["feature-link"])||"",info.description=setValidStr(data["feature-description"])||setValidStr(data["short-description"])||setValidStr(data.description)||setValidStr(data["long-description"])||"",info.link=function(){var val=setValidStr(data.link)||!1;return val||"#"}(),info.showTime=function(){var start,ret;try{start=new Date(getSchedTime(data.start)),ret=DateTime(start,"%h:%i$%AMPM ET"),ret=ret.split(":"),"0"===ret[0]&&(ret[0]="12"),ret=ret.join(":")}catch(err){}return ret}(),info.image=function(){var val=setValidStr(data["feature-image"])||setValidStr(data.image)||!1;return val?resizeImage(val,dim[0],dim[1]):"//global.fncstatic.com/static/v/all/img/clear.gif"}(),info.feature=function(){var ret=!1,title=setValidStr(data["feature-link"]),link=setValidStr(data["feature-url"]);return title&&link&&(ret={title:title,link:link}),ret}(),{info:info,raw:data}},Normalize.promo=function(data){var dim=CONST.imgSize,info={};return info.title=data.name,info.description=data.description,info.link=setValidStr(data.url)?data.url:"#",info.showTime=function(){var start,ret;try{start=new Date(getSchedTime(data.start_at)),ret=DateTime(start,"%h:%i$%AMPM ET"),ret=ret.split(":"),"0"===ret[0]&&(ret[0]="12")}catch(err){}return ret=ret.join(":")}(),info.image=function(){var val=setValidStr(data["feature-image"])||setValidStr(data.image);return val?resizeImage(val,dim[0],dim[1]):"//global.fncstatic.com/static/v/all/img/clear.gif"}(),info.feature=function(){var ret=!1,title=setValidStr(data.link_text),link=setValidStr(data.link_url);return title&&link&&(ret={title:title,link:link}),ret}(),{info:info,raw:data}},Normalize}(),setValidStr=function(val){return"string"==typeof val&&val.length>1&&val},getCurrentSchedule=function(curr,days){for(var ret=!1,day=!1,x=0;x<days.length;x++)if(isToday(curr,days[x]["@attributes"].value)){day=days[x];break}if(day&&day.show){var show=getShow(curr,day.show);ret=_.last(show)}return ret},getCurrentPromo=function(curr,promos){if(_.isUndefined(promos[0]))return!1;for(var ret=!1,x=(getMilTime(curr),0);x<promos.length;x++){var promo=promos[x];if(promo.start_at&&promo.end_at&&promo.start_at.split(" ").length>1&&promo.end_at.split(" ").length>1){var startAt=(promo.start_at.split(" ")[0],new Date(getSchedTime(promo.start_at))),endAt=new Date(getSchedTime(promo.end_at)),ct=(getMilTime(startAt),getMilTime(endAt),curr.getTime()),st=startAt.getTime(),et=endAt.getTime();if(ct>=st&&ct<et){ret=promo;break}}}return ret},getSchedTime=function(val){var sp=val.indexOf("T")>-1?val.split("T"):val.split(" "),date=sp[0],time=sp[1].split("-")[0];return date=date.split("-"),date=[date[1],date[2],date[0]].join("/"),new Date([date,time].join(" "))},getShow=function(curr,shows){for(var ret=[],currTime=getMilTime(curr),x=0;x<shows.length;x++){var show=shows[x],startTime=getMilTime(getSchedTime(show.start)),endTime=getMilTime(getSchedTime(show.end));currTime>=startTime&&currTime<endTime&&ret.push(show)}return ret},getMilTime=function(val){var mil=DateTime(val,"%H%i");return parseInt(mil,10)},isToday=function(curr,val){for(var ret=!0,currDay=DateTime(curr,"${yr}-${mm}-${dd}"),sp=currDay.split("-"),valsp=val.split("-"),x=0;x<sp.length;x++)if(valsp[x]&&parseInt(valsp[x],10)!==parseInt(sp[x],10)){ret=!1;break}return ret},resizeImage=function(u,w,h){if(isNaN(w)||isNaN(h))return u;var url=u;if(u.indexOf("a57.foxnews.com")>-1||u.indexOf("nyc.imagesizer.foxnews.com")>-1){url=u.split("/");var idx=url.length;url[idx-3]=w,url[idx-2]=h,url=url.join("/")}else{url=u.split("/");var dim="/"+w+"/"+h+"/";0===url[0].indexOf("http")&&url.splice(0,2),url.unshift("//a57.foxnews.com"),url=url.slice(0,url.length-1).join("/")+dim+url.slice(url.length-1)}return url};return App});
Modulr.define("core.plugins:Sharing",["jquery"],function($){function enc(str){return encodeURIComponent(str)}var FB_STACK=[],App=function(){this._FB_SDK_LOADED=!1,this._FB_SDK_INIT=!1};return App.prototype.facebook=function(url,appId,sdk){var self=this;if(url){var done=function(){};if(sdk){if(!appId)return;var share={method:"share",mobile_iframe:"true",href:url};this._FB_SDK_INIT?this._FB_SDK_LOADED?FB.ui(share,done):FB_STACK=[{info:share,done:done}]:(this._FB_SDK_INIT=!0,window.fbAsyncInit=function(){if(FB.init({appId:appId,xfbml:!0,version:"v2.8"}),self._FB_SDK_LOADED=!0,FB_STACK.length>0){var tmp=FB_STACK.shift();FB.ui(tmp.info,tmp.done)}else FB.ui(share,done)},function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];d.getElementById(id)||(js=d.createElement(s),js.id=id,js.src="//connect.facebook.net/en_US/sdk.js",fjs.parentNode.insertBefore(js,fjs))}(document,"script","facebook-jssdk"))}else window.open("//www.facebook.com/sharer/sharer.php?u="+enc(url),"facebook","status=1,width=660,height=334")}},App.prototype.twitter=function(data){var url=enc(data.url),title=data.title||"",params=["text="+enc(title+" | ")];params.push("url="+url),data.via&&params.push("via="+data.via),data.related&&params.push("related="+data.related);var href="//twitter.com/intent/tweet?"+params.join("&");window.open(href,"twitter","status=1,width=660,height=334")},new App});
Modulr.define("core.plugins:SocialMediaCountParsely",["jquery"],function($){function log(){if(window.console)try{return console.log.apply(console,arguments)}catch(err){console.log(arguments)}}var loc=window.location;loc.protocol;FEED_COUNTER=0;return new function(){this.get=function(urlArr,config,callback){return log("[Plugins] media count disabled."),!1}}});
Modulr.define("core.plugins:SocialMediaShare",["jquery"],function($){var App=function(config){var self=this;self.__vars={},this.API=new API(self),this.SocialMedia=new SocialMedia(self);var vars=self.__vars;vars._config={};for(var i in config){var provider=i.toLowerCase();self.SocialMedia[provider]?(vars._config[provider]=config[i],self.SocialMedia[provider]()):log("[SocialMediaShare] No Media for: "+provider)}};App.prototype.clickEvent=function(link){window.auth_fox&&window.auth_fox.badgeville&&(window.auth_fox.badgeville.trigger,!0)&&window.auth_fox.badgeville.trigger("contentShare",link)};var API=function(){return function(root){this.root=root}}(),SocialMedia=function(){var SocialMedia=function(root){this.root=root};return SocialMedia.prototype.facebook=function(){var x,self=this,root=self.root,data=root.__vars._config.facebook,urls=[],hasCountRequest=!1;for(x=0;x<data.length;x++)-1===$.inArray(data[x].url,urls)&&data[x].event&&"function"==typeof data[x].event.count&&(hasCountRequest=!0,urls.push(data[x].url)),function(data){data.target.bind("click",function(){var link=encodeURIComponent(data.url);return window.FB&&window.FB.login?FB.login(function(response){response.authResponse&&(root.clickEvent(link),window.open("//www.facebook.com/sharer/sharer.php?u="+link,"facebook","status=1,height=334,width=660"))}):(root.clickEvent(link),window.open("//www.facebook.com/sharer/sharer.php?u="+link,"facebook","status=1,height=334,width=660")),!1})}(data[x]);urls=urls.join(",");var reqURL="//graph.facebook.com/fql?format=jsonp&callback=foo&q=SELECT%20url,normalized_url,share_count,like_count,comment_count,total_count,commentsbox_count,comments_fbid,click_count%20FROM%20link_stat%20WHERE%20url%20IN%20('"+urls+"')",setCountData=function(info){for(var x=0;x<info.length;x++)for(var inf=info[x],url=inf.url,count=formatNumber(inf.total_count?inf.total_count:inf.like_count?inf.like_count:0),z=0;z<data.length;z++){var item=data[z];item.url===url&&item.event&&item.event.count&&item.event.count(count)}};hasCountRequest&&ajaxCall(reqURL,function(raw){raw&&raw.data&&$.isArray(raw.data)&&raw.data.length>0&&setCountData(raw.data)})},SocialMedia.prototype.twitter=function(){var self=this,root=self.root,data=root.__vars._config.twitter,setCountData=function(info){if(info&&info.url)for(var count=formatNumber(info.count||0),z=0;z<data.length;z++){var item=data[z];info.url.indexOf(item.url)>-1&&item.event&&item.event.count&&item.event.count(count)}};for(x=0;x<data.length;x++){if(data[x].event&&"function"==typeof data[x].event.count){var reqUrl="//urls.api.twitter.com/1/urls/count.json?callback=?&url="+data[x].url;ajaxCall(reqUrl,function(raw){setCountData(raw)})}!function(data){data.target.bind("click",function(){var link=encodeURIComponent(data.url),title=data.title||"",url=data.shortUrl?encodeURIComponent(data.shortUrl):link,relateds=data.relateds?data.relateds:"";return root.clickEvent(link),window.open("//twitter.com/intent/tweet?text="+encodeURIComponent(title+" | ")+"&url="+url+relateds,"twitter","status=1,height=334,width=660"),!1})}(data[x])}},SocialMedia.prototype.gplus=function(){var self=this,root=self.root,data=root.__vars._config.gplus,setCountData=function(info){var count=!!(info&&info.result&&info.result.metadata&&info.result.metadata.globalCounts&&void 0!==info.result.metadata.globalCounts.count)&&info.result.metadata.globalCounts.count;if(!isNaN(count)){count=formatNumber(count);for(var z=0;z<data.length;z++){var item=data[z];info.result.id.indexOf(item.url)>-1&&item.event&&item.event.count&&item.event.count(count)}}};for(x=0;x<data.length;x++)data[x].event&&"function"==typeof data[x].event.count&&$.ajax({url:"/feeds/p/gplus/count/?url="+data[x].url,dataType:"json",cache:!0,success:function(raw){setCountData(raw)}}),function(data){data.target.bind("click",function(){var link=encodeURIComponent(data.url);data.title,data.relateds&&data.relateds;return root.clickEvent(link),window.open("//plus.google.com/share?url="+link,"googleplus","status=1,height=334,width=660"),!1})}(data[x])},SocialMedia.prototype.pinterest=function(){var self=this,root=self.root,data=root.__vars._config.pinterest,setCountData=function(info){if(info&&info.url)for(var count=formatNumber(info.count||0),z=0;z<data.length;z++){var item=data[z];info.url.indexOf(item.url)>-1&&item.event&&item.event.count&&item.event.count(count)}};for(x=0;x<data.length;x++)data[x].event&&"function"==typeof data[x].event.count&&$.ajax({url:"//api.pinterest.com/v1/urls/count.json?callback=receiveCount&url="+data[x].url,dataType:"json",cache:!0,success:function(raw){setCountData(raw)}}),function(data){data.target.bind("click",function(){var link=encodeURIComponent(data.url),image=$("meta[property='og:image']").attr("content");data.title,data.shortUrl&&encodeURIComponent(data.shortUrl),data.relateds&&data.relateds;return root.clickEvent(link),window.open("//pinterest.com/pin/create/button/?url="+link+"&media="+image,"pinterest","status=1,height=334,width=660"),!1})}(data[x])},SocialMedia}(),ajaxCall=function(url,callbackFN){$.ajax({url:url,dataType:"jsonp",success:callbackFN})},formatNumber=function(val){return val=parseInt(val,10),val=val>=1e3?Math.floor(val/1e3).toString()+"k":val.toString()},log=function(){if(window.console)try{return console.log.apply(console,arguments)}catch(err){console.log(arguments)}};return function(config){if(!config)return!1;var APP=new App(config),PUBLIC_APP=function(){};return PUBLIC_APP.prototype.API=APP.API,new PUBLIC_APP}});
Modulr.define("core.plugins:TouchEventListener",["jquery"],function($){var TouchEvents=function(target){function setListeners(item){var trigger=null,setOrigin=null,directionalOnce=null,properties={scale:{},move:{origin:{},current:{},diff:{}}};item.on("touchstart",function(evt){trigger=!0,setOrigin=!1,directionalOnce=!1,triggerCallback("touchend",{event:evt.originalEvent})}),item.on("touchend",function(evt){trigger=!1,directionalOnce=!1,triggerCallback("touchend",{event:evt.originalEvent})}),item.on("gesturestart",function(evt){var event=evt.originalEvent,scale=setScale(event.scale);triggerCallback("gesturestart",{event:event}),properties.scale.current=properties.scale.current||scale,properties.scale.changed=!1}),item.on("gestureend",function(evt){var event=evt.originalEvent,scale=setScale(event.scale);triggerCallback("gestureend",{event:event}),properties.scale.current!==scale&&(properties.scale.current=scale,properties.scale.changed=!0,triggerCallback("scale",{event:event}))}),item.on("touchmove",function(evt){var event=evt.originalEvent,touches=event.touches[0],pageX=touches.pageX,pageY=touches.pageY;properties.move.current={x:pageX,y:pageY},setOrigin||(properties.move.origin={x:pageX,y:pageY},setOrigin=!0);var origin=properties.move.origin;properties.move.diff={x:pageX-origin.x,y:pageY-origin.y},function(){if(!directionalOnce){var direction=[];pageX>=origin.x+SENSITIVITY?direction.push("right"):pageX<=origin.x-SENSITIVITY&&direction.push("left"),pageY<=origin.y-SENSITIVITY?direction.push("up"):pageY>=origin.y+SENSITIVITY&&direction.push("down"),direction.length>0&&(triggerCallback("swipe",{direction:direction,properties:properties,event:event}),directionalOnce=!0)}}()})}function triggerCallback(id,data){if(EVENTS_STACK[id])for(var i=0,stack=EVENTS_STACK[id];i<stack.length;i++)stack[i](data)}function setScale(scale){var res=1;return isNaN(scale)||(res=Math.round(100*scale)/100),res}var Proto=this,EVENTS_STACK={swipe:null,scale:null,touchstart:null,touchend:null,gesturestart:null,gestureend:null},SENSITIVITY=15;Proto.on=function(event,callback){return void 0!==EVENTS_STACK[event]&&("function"==typeof callback&&(EVENTS_STACK[event]||(EVENTS_STACK[event]=[]),void EVENTS_STACK[event].push(callback)))},target.each(function(){setListeners($(this))})};return function(target,conf){return new TouchEvents(target,conf)}});
Modulr.define("core.plugins:TwitterConnector",["jquery"],function($){var CONST={};CONST.apiPath="/feeds/p/twitter/1.1/",CONST.type={search:{feed:CONST.apiPath+"search/tweets/",required:["q"]},timeline:{feed:CONST.apiPath+"statuses/user_timeline/",required:["screen_name"]}};var App=function(){};App.prototype.init=function(){},App.prototype.apiCall=function(config,callback){var type=config.type,refresh=config.refreshUrl||!1,params=config.params||{};if(!CONST.type[type])return log("[Twitter.Connector] Unknown type: "+type),!1;var conf=CONST.type[type],url=conf.feed,required=conf.required;if(refresh)url+=refresh;else if(!validParams(params,required))return log("[Twitter.Connector] Required Parameters missing."),!1;params.cb=cacheBuster(2),"function"==typeof callback&&$.ajax({url:url,data:params,dataType:"json",success:function(data){var norm=FeedNormalizer[type]?FeedNormalizer[type](data):data;callback(norm)}})},App.prototype.formatTweet=function(str,types){return formatMessage(str,types)};var FeedNormalizer=function(){var FeedNormalizer={};return FeedNormalizer.search=function(data){var x,items=data.statuses,itemLen=items.length;for(x=0;x<itemLen;x++)data.statuses[x]=function(item){return item.textFormatted=formatMessage(item.text),item}(items[x]);return data},FeedNormalizer.timeline=function(data){var x,len=data.length;for(x=0;x<len;x++)data[x]=function(item){return item.textFormatted=formatMessage(item.text),item}(data[x]);return data},FeedNormalizer}(),formatMessage=function(text,types){var x,i,z,replace={},matches={links:text.match(/\http:\/\/\S+/gi),users:text.match(/@[a-zA-Z0-9\-\_]+/gi),terms:text.match(/#[a-zA-Z0-9\-\_]+/gi)},replaceTMP={links:'<a target="_blank" href="${item}" target="_blank" class="hyper-word">${item}</a>',users:'<a target="_blank" href="//twitter.com/${link}">${item}</a>',terms:'<a target="_blank" href="//twitter.com/${link}">${item}</a>'};if(types)for(z=0;z<types.lenth;z++){var t=type[z];replaceTMP[t]&&(replace[t]=replaceTMP[t])}else replace=replaceTMP;for(i in matches){var match=matches[i];if(match&&replace[i]){var len=match.length;for(x=0;x<len;x++){var item=match[x];text="users"===i?text.replace(item,replace[i].replace(/(\$\{item\})/g,item).replace(/(\$\{link\})/g,item.slice(1))):"terms"===i?text.replace(item,replace[i].replace(/(\$\{item\})/g,item).replace(/(\$\{link\})/g,"search?q="+item.slice(1))):text.replace(item,replace[i].replace(/(\$\{item\})/g,item))}}}return text},validParams=function(params,required){var x,ret=!0;for(x=0;x<required.length;x++)if(!params[required[x]]){ret=!1;break}return ret},cacheBuster=function(freq){freq=freq||!1;var date=new Date,str=date.getFullYear().toString()+(date.getMonth()+1).toString()+date.getDate().toString(),hr=date.getHours()+1,min=date.getMinutes();return str+=hr.toString()+(freq&&!isNaN(freq)?Math.floor(min/parseFloat(freq)).toString():"")},log=function(){if(window.console)try{return console.log.apply(console,arguments)}catch(err){console.log(arguments)}};return App});
Modulr.define("core.plugins:URLInfo",[],function(){function buildUrl(info){var url=info.path,query=joinPair(info.query),hash=joinPair(info.hash);return url+(query?"?"+query:"")+(hash?"#"+hash:"")}function joinPair(pair){var arr=[];for(var i in pair){var val=pair[i];val?arr.push([i,encodeURIComponent(val)].join("=")):arr.push(i)}return arr?arr.join("&"):""}function getInfo(url){var sp=url.split("?"),path=sp[0],query=sp[1]||"",hash="";if(query.length>0){var hs=query.split("#");hash=trim(hs[1]||""),hash.length>0&&(query=hs[0])}else{var ps=path.split("#");hash=trim(ps[1]||""),hash.length>0&&(path=ps[0])}return{path:path,query:itemize(query),hash:itemize(hash)}}function itemize(info){for(var si=info.split("&"),obj={},i=0;i<si.length;i++){if(si[i].length>0){var s=si[i].split("=");obj[s[0]]=s[1]||""}}return obj}function trim(str){return str.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}return function(URL){var Proto=this,INFO=getInfo(URL);Proto.addQuery=function(pair,returnUrl){for(var i in pair)INFO.query[i]=pair[i];var ret=INFO;return returnUrl&&(ret=buildUrl(INFO)),ret},Proto.addHash=function(pair,returnUrl){for(var i in pair)INFO.hash[i]=pair[i];var ret=INFO;return returnUrl&&(ret=buildUrl(INFO)),ret},Proto.getUrl=function(){return buildUrl(INFO)},Proto.getInfo=function(){return INFO}}});
Modulr.define("core.plugins:WatchNow",["jquery","MultiFeedParser","AKAMAI_TIME_HELPER","DateTime"],function($,MultiFeedParser,AKAMAI_TIME_HELPER,DateTime){var CONST={};CONST.feeds={},CONST.feeds.FN={"sched-tool":"//www.foxnews.com/feeds/schedule/channel/foxnewscom-live/feed/json",playlist:"//interactive.foxnews.com/projects/watch-now/live.js"},CONST.feeds.FNL={"sched-tool":"//www.foxnews.com/feeds/schedule/channel/foxnewscom-live/feed/json",playlist:"//video.foxnews.com/v/feed/playlist/5218470496001.js?template=fox"},CONST.feeds.FB={"sched-tool":"//www.foxbusiness.com/feeds/watch/show-schedule/feed/json/",playlist:"//video.foxbusiness.com/v/feed/playlist/932683241001.js?template=fox"},CONST.feeds.SBC={"sched-tool":"//www.foxbusiness.com/feeds/watch/show-schedule/feed/json/",playlist:"//video.foxbusiness.com/v/feed/playlist/937116525001.js?template=fox"},CONST.config={},CONST.config.imageDimension=[132,74],CONST.config.imagePattern="/static/p/video/img/live/schedule/144x81-live-${machineTitle}.jpg";var App=function(config){var self=this;self.__vars={};var v=self.__vars;v.data={},config=config&&"object"==typeof config&&!$.isArray(config)?config:{},v._config=config,config.parserOnly||setFeedParser(v)};App.prototype.getData=function(callback){var self=this,v=self.__vars,parserOnly=!(!v._config||!v._config.parserOnly);if("function"!=typeof callback||parserOnly)return!1;v._parser.event.onLoad("sched-tool",function(schedData){v.data["sched-tool"]=schedData,v._parser.event.getData("playlist",function(playlistData){v.data.playlist=playlistData;var normalize=normalizeBoth(schedData,playlistData);callback(normalize)})})},App.prototype.getScheduleFeed=function(callback){var self=this,v=self.__vars,parserOnly=!(!v._config||!v._config.parserOnly);if("function"!=typeof callback||parserOnly)return!1;v._parser.event.onLoad("sched-tool",function(data){v.data["sched-tool"]=data,callback(data)})},App.prototype.getPlaylistFeed=function(callback){var self=this,v=self.__vars,parserOnly=!(!v._config||!v._config.parserOnly);if("function"!=typeof callback||parserOnly)return!1;v._parser.event.onLoad("playlist",function(data){v.data.playlist=data,callback(data)})},App.prototype.parseScheduleData=function(feedData,config,full){return normalizeSchedTool(feedData,config,full)};var setFeedParser=function(vars){var config=vars._config,feed=CONST.feeds.FN;"foxbusiness"===config.site?feed=CONST.feeds.FB:"smallbusiness"===config.site?feed=CONST.feeds.SBC:"latino"===config.site&&(feed=CONST.feeds.FNL);var refresh=!1;config.refresh&&!isNaN(config.refresh)&&(refresh=parseInt(config.refresh,10));var feedConfig={};feedConfig.feeds={},feedConfig.logging=!0,feedConfig.initOnLoad=!0,refresh&&(feedConfig.cacheTime=refresh),feedConfig.feeds.playlist={url:feed.playlist,jsonpCallback:"FOX_WatchNowPlaylist",normalize:function(data){var ret=data;return data&&(ret=normalizePlaylist(config,data)),ret}},feedConfig.feeds["sched-tool"]={url:feed["sched-tool"],jsonpCallback:"FOX_WatchNowSchedTool",normalize:function(data){var ret=data,full=!!config.fullSchedule;return data&&(ret=normalizeSchedTool(data,config,full)),ret}},vars._parser=new MultiFeedParser(feedConfig)},normalizeBoth=function(sched,playlist){var len=playlist.length>999?999:playlist.length,arr=[];sched&&arr.push(sched);for(var cntr=0,liveArr=[];cntr<playlist.length;)playlist[cntr]&&playlist[cntr].isLive?(liveArr.push(playlist[cntr]),playlist.splice(cntr,1)):cntr+=1;for(playlist.reverse(),liveArr.reverse(),playlist=playlist.concat(liveArr),playlist.reverse(),x=0;x<len;x+=1)arr.push(playlist[x]);return arr.length%2!=0&&arr.pop(),arr},normalizePlaylist=function(config,data){var info=!!(data&&data.channel&&data.channel.item)&&data.channel.item;if(!info)return!1;info=$.isArray(info)?info:[info];var x,arr=[],len=info.length,dim=config.imageDimension?config.imageDimension:CONST.config.imageDimension,isLive=function(val){var ret=!1;if(val){val=$.isArray(val)?val:[val];for(var i=0;i<val.length;i+=1)if(val[i].indexOf("live_stream")>-1){ret=!0;break}}return ret};for(x=0;x<len;x+=1)arr.push(function(item){var img=setResizerDimension(item["media-group"]["media-thumbnail"]["@attributes"].url,dim);return{isLive:isLive(item.category),title:item.title,link:item.link,guid:item.guid,img:img,raw:item}}(info[x]));return arr},normalizeSchedTool=function(data,config,full){var x,ret,arr=[],latest=[],currentShow=!1,items=data.day,nowDate=AKAMAI_TIME_HELPER.getCurrent(),maxLatestLen=config&&config.maxLatest?config.maxLatest:3,pushShow=function(showInfo,idx,isCurrent){isCurrent=isCurrent||!1,latest.push({current:isCurrent,show:showInfo,index:idx})};for(x=0;x<items.length;x+=1)!function(item){var z,shows=item.show||[];for(shows=$.isArray(shows)?shows:[shows],z=0;z<shows.length;z+=1){var show=shows[z];show.start=setSchedTime(show.start),show.end=setSchedTime(show.end),show.description="string"!=typeof show.description?"":$("<div></div>").text(show.description).text(),show.showImg=function(macTitle,custom){macTitle="string"==typeof macTitle?$.trim(macTitle):"";var ret="//global.fncstatic.com/static/v/all/img/clear.gif",dim=config.imageDimension?config.imageDimension:CONST.config.imageDimension;if(custom)ret=setImageResizer(custom,dim);else if(macTitle.length>0){var pat,macImg="//global.fncstatic.com";config.imagePatternFull?(pat=config.imagePatternFull,pat=pat.replace("${machineTitle}",macTitle),macImg=pat):config.imagePattern?(pat=config.imagePattern,pat=pat.replace("${machineTitle}",macTitle),macImg+=pat):macImg+=CONST.config.imagePattern.replace("${machineTitle}",macTitle),ret=setImageResizer(macImg,dim)}return ret}(show["machine-title"],show.image),arr.push(show),show.start_early=new Date(show.start.getTime()-3e5),!currentShow&&show.start_early<=nowDate&&show.end>=nowDate?(latest=[],pushShow(show,arr.length-1,!0),currentShow=!0):latest.length<maxLatestLen&&currentShow?pushShow(show,arr.length-1):latest.length<maxLatestLen&&show.start>=nowDate&&pushShow(show,arr.length-1)}}(items[x]);ret={latest:latest,normalized:arr,raw:data};var norm={};return latest=!!(ret&&ret.latest[0]&&ret.latest[0].current)&&ret.latest[0].show,latest?(norm={title:latest.title,img:latest.showImg,isLive:!0,link:latest.link,guid:latest["machine-title"],webShow:!0,raw:latest,rawDump:ret},ret=norm):full?(norm={rawDump:ret},ret=norm):ret=latest,ret},setResizerDimension=function(url,dim){if(!dim)return url;var arr=url.split("/"),len=arr.length,width=arr[len-3],height=arr[len-2];return arr[len-3]=isNaN(width)?width:dim[0],arr[len-2]=isNaN(height)?height:dim[1],arr.join("/")},setImageResizer=function(url,dim){if(!dim)return url;var src=url.replace("//",""),arr=src.split("/"),len=arr.length;return arr[len-1]=dim.join("/")+"/"+arr[len-1],"//a57.foxnews.com/"+arr.join("/")},setSchedTime=function(val){var ret;if(val instanceof Date)ret=val;else{var sp=val.indexOf("T")>-1?val.split("T"):val.split(" "),date=sp[0],time=sp[1].split("-")[0];date=date.split("-"),date=[date[1],date[2],date[0]].join("/"),ret=new Date([date,time].join(" "))}return ret};return App});
!function(Modulr,FNC){var uid="core.plugins";if(Modulr.getInstance(uid))return!1;var config={instance:uid,baseDomain:FNC.CDN.domain,baseUrl:"/static/orion/scripts/core/plugins/app",shim:{jquery:{src:"/static/orion/scripts/core/utils/jquery/core.js",exports:"jQuery"},lodash:{src:"/static/orion/scripts/core/utils/lodash.js",exports:"_"},AKAMAI_TIME_HELPER:{src:"//global.fncstatic.com/static/v/all/js/geo.js",exports:"AKAMAI_TIME_HELPER"}}},Instance=Modulr.config(config);Instance.define("ENV",function(){return FNC.CDN.env}),Instance.define("STATIC_DOMAIN",function(){return FNC.CDN.domain}),Instance.define("ISA",function(){return FNC.ISA})}(window.Modulr,function(){return window.FNC=window.FNC||{},window.FNC.CDN=window.FNC.CDN||function(){function idx(e,v){return e.indexOf(v)>-1?1:0}for(var type="prod",found=!1,scripts=document.getElementsByTagName("script"),i=0;i<scripts.length;i++){var src=scripts[i].getAttribute("src")||"";if(src&&(idx(src,"fncstatic.com/static/")||idx(src,"foxnews.com/static/")||idx(src,"foxbusiness.com/static/")||idx(src,"/static/v"))){found=src;break}}found&&(idx(found,"qa.global.")||idx(found,"-qa.")?type="qa":idx(found,"staging.")?type="staging":idx(found,"global.fncstatic")||(type="relative"));var domain="global.fncstatic.com",env="relative"===type?"prod":type;switch(type){case"qa":domain="qa."+domain;break;case"staging":domain=["v8-staging","foxnews.com"].join(".");break;case"relative":domain=window.location.host}return domain="//"+domain,window.FOX_ENV_STATIC_DOMAIN=domain,window.FOX_ENV_STATIC=env,{domain:domain,env:env}}(),window.FNC}());