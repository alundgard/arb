/*! updated; 02-19-2018 09:01 AM */

Modulr.define("FOX_PLUGINS:BrowserVisibilityState",[],function(){var CALL_STACK=[],App=function(){function addEvent(event,callback){document.addEventListener?document.addEventListener(event,callback,!1):document.attachEvent&&document.attachEvent("on"+event,callback)}function triggerStack(state){for(var i=0;i<CALL_STACK.length;i++)CALL_STACK[i](getState(state))}function getState(val){var ret="focus"===val?"visible":"blur"===val?"hidden":"visible"!==val?"hidden":"visible";return ret}var Proto=this;Proto.onChange=function(callback){"function"==typeof callback&&CALL_STACK.push(callback)};var event,state,prefixArr=["moz","ms","o","webkit"],prefix="",hidden=null;if("hidden"in document)hidden="hidden",event="visibilitychange",state="visibilityState";else{for(var i=0;i<prefixArr.length;i++)if(prefixArr[i]+"Hidden"in document){prefix=prefixArr;break}prefix&&(hidden=prefix+"Hidden",event=prefix+"visibilitychange",state=prefix+"VisibilityState")}hidden?addEvent(event,function(){triggerStack(document[state])}):"onfocusin"in document?(addEvent("focusin",function(){triggerStack("focus")}),addEvent("focusout",function(){triggerStack("blur")})):(addEvent("focus",function(){triggerStack("focus")}),addEvent("blur",function(){triggerStack("blur")}))};return new App});