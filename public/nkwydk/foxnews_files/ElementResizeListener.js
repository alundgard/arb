/*! updated; 07-19-2016 12:49 PM */

Modulr.define("FOX_PLUGINS:ElementResizeListener",["jquery"],function($){var CONST={};CONST.eventName="Event.ResizeListener";var App=function(config){this._initialized=!1,this._elm=config.elm,this._DIM={},this._resizeBindArr=[],this.API=new API(this),$.isArray(config.min)&&(this._DIM.min=[fmtVal(config.min[0]),fmtVal(config.min[1])]),$.isArray(config.max)&&(this._DIM.max=[fmtVal(config.max[0]),fmtVal(config.max[1])]),this.init()};App.prototype.init=function(){var self=this,DIM=self._DIM,elm=self._elm;return self._initialized?!1:(self._initialized=!0,DIM.curr=[elm.width(),getRatioHeight(elm.width(),DIM.max)],DIM.curr=setDimFromRange(DIM.curr,DIM.min,DIM.max),elm.bind(CONST.eventName,function(){for(var x=0;x<self._resizeBindArr.length;x++)self._resizeBindArr[x](self._DIM.curr)}),void AddWindowResizeListener(function(){DIM.curr=[elm.width(),getRatioHeight(elm.width(),DIM.max)],DIM.curr=setDimFromRange(DIM.curr,DIM.min,DIM.max),elm.trigger(CONST.eventName)}))};var API=function(){var API=function(root){this.root=root};return API.prototype.getCurrentSize=function(fn){var self=this,root=self.root,DIM=root._DIM,elm=root._elm;DIM.curr=[elm.width(),getRatioHeight(elm.width(),DIM.max)],DIM.curr=setDimFromRange(DIM.curr,DIM.min,DIM.max),"function"==typeof fn&&fn(DIM.curr)},API.prototype.onWindowResize=function(fn){var self=this,root=self.root;root._DIM,root._elm;"function"==typeof fn&&root._resizeBindArr.push(fn)},API}(),setDimFromRange=function(curr,min,max){var dim=[curr[0],curr[1]];return max&&(dim[0]=max[0]&&curr[0]<=max[0]?curr[0]:max[0]),min&&(dim[0]=min[0]&&curr[0]>=min[0]?curr[0]:min[0]),dim[1]=getRatioHeight(dim[0],max),dim},fmtVal=function(val){return"string"==typeof val&&(val=val.replace(/[^0-9]/gi,"")),val=isNaN(val)?!1:parseInt(val,10)},getRatioHeight=function(w,full){var ratio=(full[0]-(full[0]-w))/full[0],newH=Math.floor(full[1]*ratio);return newH},AddWindowResizeListener=function(fn){var timeout,hasOrientation="onorientationchange"in window?!0:!1,onEvent=hasOrientation?"orientationchange":"resize",ua=navigator.userAgent.toLowerCase(),isKindle=ua.indexOf("silk")>-1?!0:!1,isAndroid=ua.indexOf("android")>-1?!0:!1,timeoutDelay=isKindle?250:isAndroid?100:!1;$(window).bind(onEvent,function(){timeoutDelay?(clearTimeout(timeout),timeout=setTimeout(function(){fn()},timeoutDelay)):fn()})};return App});