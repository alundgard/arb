/**
 * @license almond 0.2.9 Copyright (c) 2011-2014, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 */

!function(n,e){if("object"==typeof Livefyre&&"function"==typeof Livefyre.define&&Livefyre.define.amd)Livefyre.define([],e);else if("function"==typeof define&&define.amd)define([],e);else{var t=e();n.Livefyre=n.Livefyre||{},n.Livefyre.auth=t}}(this,function(){var n,e,t;return function(i){function r(n,e){return k.call(n,e)}function o(n,e){var t,i,r,o,u,a,f,c,l,s,p,d=e&&e.split("/"),g=y.map,h=g&&g["*"]||{};if(n&&"."===n.charAt(0))if(e){for(d=d.slice(0,d.length-1),n=n.split("/"),u=n.length-1,y.nodeIdCompat&&x.test(n[u])&&(n[u]=n[u].replace(x,"")),n=d.concat(n),l=0;l<n.length;l+=1)if(p=n[l],"."===p)n.splice(l,1),l-=1;else if(".."===p){if(1===l&&(".."===n[2]||".."===n[0]))break;l>0&&(n.splice(l-1,2),l-=2)}n=n.join("/")}else 0===n.indexOf("./")&&(n=n.substring(2));if((d||h)&&g){for(t=n.split("/"),l=t.length;l>0;l-=1){if(i=t.slice(0,l).join("/"),d)for(s=d.length;s>0;s-=1)if(r=g[d.slice(0,s).join("/")],r&&(r=r[i])){o=r,a=l;break}if(o)break;!f&&h&&h[i]&&(f=h[i],c=l)}!o&&f&&(o=f,a=c),o&&(t.splice(0,a,o),n=t.join("/"))}return n}function u(n,e){return function(){return d.apply(i,w.call(arguments,0).concat([n,e]))}}function a(n){return function(e){return o(e,n)}}function f(n){return function(e){v[n]=e}}function c(n){if(r(m,n)){var e=m[n];delete m[n],b[n]=!0,p.apply(i,e)}if(!r(v,n)&&!r(b,n))throw Error("No "+n);return v[n]}function l(n){var e,t=n?n.indexOf("!"):-1;return t>-1&&(e=n.substring(0,t),n=n.substring(t+1,n.length)),[e,n]}function s(n){return function(){return y&&y.config&&y.config[n]||{}}}var p,d,g,h,v={},m={},y={},b={},k=Object.prototype.hasOwnProperty,w=[].slice,x=/\.js$/;g=function(n,e){var t,i=l(n),r=i[0];return n=i[1],r&&(r=o(r,e),t=c(r)),r?n=t&&t.normalize?t.normalize(n,a(e)):o(n,e):(n=o(n,e),i=l(n),r=i[0],n=i[1],r&&(t=c(r))),{f:r?r+"!"+n:n,n:n,pr:r,p:t}},h={require:function(n){return u(n)},exports:function(n){var e=v[n];return void 0!==e?e:v[n]={}},module:function(n){return{id:n,uri:"",exports:v[n],config:s(n)}}},p=function(n,e,t,o){var a,l,s,p,d,y,k=[],w=typeof t;if(o=o||n,"undefined"===w||"function"===w){for(e=!e.length&&t.length?["require","exports","module"]:e,d=0;d<e.length;d+=1)if(p=g(e[d],o),l=p.f,"require"===l)k[d]=h.require(n);else if("exports"===l)k[d]=h.exports(n),y=!0;else if("module"===l)a=k[d]=h.module(n);else if(r(v,l)||r(m,l)||r(b,l))k[d]=c(l);else{if(!p.p)throw Error(n+" missing "+l);p.p.load(p.n,u(o,!0),f(l),{}),k[d]=v[l]}s=t?t.apply(v[n],k):void 0,n&&(a&&a.exports!==i&&a.exports!==v[n]?v[n]=a.exports:s===i&&y||(v[n]=s))}else n&&(v[n]=t)},n=e=d=function(n,e,t,r,o){if("string"==typeof n)return h[n]?h[n](e):c(g(n,e).f);if(!n.splice){if(y=n,y.deps&&d(y.deps,y.callback),!e)return;e.splice?(n=e,e=t,t=null):n=i}return e=e||function(){},"function"==typeof t&&(t=r,r=o),r?p(i,n,e,t):setTimeout(function(){p(i,n,e,t)},4),d},d.config=function(n){return d(n)},n._defined=v,t=function(n,e,t){e.splice||(t=e,e=[]),r(v,n)||r(m,n)||(m[n]=[n,e,t])},t.amd={jQuery:!0}}(),t("almond",function(){}),t("mout/array/slice",[],function(){function n(n,e,t){var i=n.length;e=null==e?0:0>e?Math.max(i+e,0):Math.min(e,i),t=null==t?i:0>t?Math.max(i+t,0):Math.min(t,i);for(var r=[];t>e;)r.push(n[e++]);return r}return n}),t("mout/function/bind",["../array/slice"],function(n){function e(e,t){var i=n(arguments,2);return function(){return e.apply(t,i.concat(n(arguments)))}}return e}),t("backplane-auth-plugin/util/jsonp",["require","exports","module"],function(n,e,t){function i(n,e){function t(){r.parentNode&&r.parentNode.removeChild(r),window[i]=void 0}var i="_lfcallback_"+ +new Date,r=document.createElement("script"),o=n.indexOf("?")>0?"&":"?";window[i]=function(n){t(),e(null,n)},r.type="text/javascript",r.async=!0,r.onerror=function(){t(),e("error")},r.src=n+o+"callback="+i,document.getElementsByTagName("head")[0].appendChild(r)}t.exports={req:i}}),t("backplane-auth-plugin/index",["require","exports","module","mout/function/bind","backplane-auth-plugin/util/jsonp"],function(n,e,t){function i(n){for(var e,t,i=n.length;i--;)if(e=n[i],t=e.type||(e.message||{}).type,t===s.LOGIN||t===s.LOGOUT)return e;return null}function r(n,e){function t(n){e(n)}var r=window.Backplane.getChannelID()||null;n.subscribe(t),l.req(r,function(n,e){if(!n&&e.length){var r=i(e);r&&t(r.message)}})}function o(n,e){function t(n){e(n)}n.subscribe(t);var r=n.getCachedMessages();if(r.length){var o=i(r);o&&t(o)}}function u(n,e){var t=n.version;if(p.v12.test(t))return r(n,e);if(p.v20.test(t))return o(n,e);throw"Backplane delegate is only compatible with version 1.2 and 2.0 of Backplane"}function a(n){if(!n)throw"missing network parameter";return function(e){function t(){u(i,c(f,this,e,n))}var i=window.Backplane;if(!i)throw"missing global backplane instance";i(t)}}function f(n,e,t){var i=t.type;switch(i){case s.LOGIN:if(n.get("livefyre"))return;n.authenticate({livefyre:{bpChannel:t.channel||window.Backplane.getChannelID(),network:e}});break;case s.LOGOUT:n.emit("logout");break;default:throw"This Backplane message type is not supported: "+i}}var c=n("mout/function/bind"),l=n("backplane-auth-plugin/util/jsonp"),s={LOGIN:"identity/login",LOGOUT:"identity/logout"},p={v12:/1\.2\.[0-9]/,v20:/2\.0\.[0-9]/};t.exports=a}),t("backplane-auth-plugin",["backplane-auth-plugin/index"],function(n){return n}),e("backplane-auth-plugin")});