/*! updated; 02-19-2018 09:01 AM */

Modulr.define("FOX_PLUGINS:SocialMediaShare",["jquery"],function($){var App=function(config){var self=this;self.__vars={},this.API=new API(self),this.SocialMedia=new SocialMedia(self);var vars=self.__vars;vars._config={};for(var i in config){var provider=i.toLowerCase();self.SocialMedia[provider]?(vars._config[provider]=config[i],self.SocialMedia[provider]()):log("[SocialMediaShare] No Media for: "+provider)}};App.prototype.clickEvent=function(link){window.auth_fox&&window.auth_fox.badgeville&&window.auth_fox.badgeville.trigger("contentShare",link)};var API=function(){var API=function(root){this.root=root};return API}(),SocialMedia=function(){var SocialMedia=function(root){this.root=root};return SocialMedia.prototype.facebook=function(){var x,self=this,root=self.root,data=root.__vars._config.facebook,setClickShare=function(data){data.target.bind("click",function(){var link=encodeURIComponent(data.url);return window.FB&&window.FB.login?FB.login(function(response){response.authResponse&&(root.clickEvent(link),window.open("//www.facebook.com/sharer/sharer.php?u="+link,"facebook","status=1,height=334,width=660"))}):(root.clickEvent(link),window.open("//www.facebook.com/sharer/sharer.php?u="+link,"facebook","status=1,height=334,width=660")),!1})},urls=[],hasCountRequest=!1;for(x=0;x<data.length;x++)-1===$.inArray(data[x].url,urls)&&data[x].event&&"function"==typeof data[x].event.count&&(hasCountRequest=!0,urls.push(data[x].url)),setClickShare(data[x]);urls=urls.join(",");var reqURL="//graph.facebook.com/fql?format=jsonp&callback=foo&q=SELECT%20url,normalized_url,share_count,like_count,comment_count,total_count,commentsbox_count,comments_fbid,click_count%20FROM%20link_stat%20WHERE%20url%20IN%20('"+urls+"')",setCountData=function(info){for(var x=0;x<info.length;x++)for(var inf=info[x],url=inf.url,count=formatNumber(inf.total_count?inf.total_count:inf.like_count?inf.like_count:0),z=0;z<data.length;z++){var item=data[z];item.url===url&&item.event&&item.event.count&&item.event.count(count)}};hasCountRequest&&ajaxCall(reqURL,function(raw){raw&&raw.data&&$.isArray(raw.data)&&raw.data.length>0&&setCountData(raw.data)})},SocialMedia.prototype.twitter=function(){var self=this,root=self.root,data=root.__vars._config.twitter,setClickShare=function(data){data.target.bind("click",function(){var link=encodeURIComponent(data.url),title=data.title||"",url=data.shortUrl?encodeURIComponent(data.shortUrl):link,relateds=data.relateds?data.relateds:"";return root.clickEvent(link),window.open("//twitter.com/intent/tweet?text="+encodeURIComponent(title+" | ")+"&url="+url+relateds,"twitter","status=1,height=334,width=660"),!1})},setCountData=function(info){if(info&&info.url)for(var count=formatNumber(info.count||0),z=0;z<data.length;z++){var item=data[z];info.url.indexOf(item.url)>-1&&item.event&&item.event.count&&item.event.count(count)}};for(x=0;x<data.length;x++){if(data[x].event&&"function"==typeof data[x].event.count){var reqUrl="//urls.api.twitter.com/1/urls/count.json?callback=?&url="+data[x].url;ajaxCall(reqUrl,function(raw){setCountData(raw)})}setClickShare(data[x])}},SocialMedia.prototype.gplus=function(){var self=this,root=self.root,data=root.__vars._config.gplus,setClickShare=function(data){data.target.bind("click",function(){var link=encodeURIComponent(data.url);data.title,data.relateds?data.relateds:"";return root.clickEvent(link),window.open("//plus.google.com/share?url="+link,"googleplus","status=1,height=334,width=660"),!1})},setCountData=function(info){var count=info&&info.result&&info.result.metadata&&info.result.metadata.globalCounts&&"undefined"!=typeof info.result.metadata.globalCounts.count?info.result.metadata.globalCounts.count:!1;if(!isNaN(count)){count=formatNumber(count);for(var z=0;z<data.length;z++){var item=data[z];info.result.id.indexOf(item.url)>-1&&item.event&&item.event.count&&item.event.count(count)}}};for(x=0;x<data.length;x++)data[x].event&&"function"==typeof data[x].event.count&&$.ajax({url:"/feeds/p/gplus/count/?url="+data[x].url,dataType:"json",cache:!0,success:function(raw){setCountData(raw)}}),setClickShare(data[x])},SocialMedia.prototype.pinterest=function(){var self=this,root=self.root,data=root.__vars._config.pinterest,setClickShare=function(data){data.target.bind("click",function(){var link=encodeURIComponent(data.url),image=$("meta[property='og:image']").attr("content");data.title||"",data.shortUrl?encodeURIComponent(data.shortUrl):link,data.relateds?data.relateds:"";return root.clickEvent(link),window.open("//pinterest.com/pin/create/button/?url="+link+"&media="+image,"pinterest","status=1,height=334,width=660"),!1})},setCountData=function(info){if(info&&info.url)for(var count=formatNumber(info.count||0),z=0;z<data.length;z++){var item=data[z];info.url.indexOf(item.url)>-1&&item.event&&item.event.count&&item.event.count(count)}};for(x=0;x<data.length;x++)data[x].event&&"function"==typeof data[x].event.count&&$.ajax({url:"//api.pinterest.com/v1/urls/count.json?callback=receiveCount&url="+data[x].url,dataType:"json",cache:!0,success:function(raw){setCountData(raw)}}),setClickShare(data[x])},SocialMedia}(),ajaxCall=function(url,callbackFN){$.ajax({url:url,dataType:"jsonp",success:callbackFN})},formatNumber=function(val){return val=parseInt(val,10),val=val>=1e3?Math.floor(val/1e3).toString()+"k":val.toString()},log=function(){var loggerON=!0;if(loggerON&&window.console)try{return console.log.apply(console,arguments)}catch(err){console.log(arguments)}},PUBLIC_APP=function(config){if(!config)return!1;var APP=new App(config),PUBLIC_APP=function(){};return PUBLIC_APP.prototype.API=APP.API,new PUBLIC_APP};return PUBLIC_APP});